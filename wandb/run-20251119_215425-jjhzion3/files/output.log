
21:54:30 | [INFO] | [RDP-sepfpl] 轮次 1: ε=0.016026, std=2.468539
Epoch 1/3 [Batch]:   0%|                                                                                     | 0/59 [00:00<?, ?it/s]
21:54:33 | [WARNING] | [HCSE] 聚类与聚合出现异常，跳过本步: selected index k out of range

Epoch 1/3 [Batch]:   3%|██                                                           | 2/59 [00:03<01:47,  1.89s/it, avg_acc=52.50%]
21:54:36 | [WARNING] | [HCSE] 聚类与聚合出现异常，跳过本步: selected index k out of range

Epoch 1/3 [Batch]:   5%|███                                                          | 3/59 [00:05<01:33,  1.68s/it, avg_acc=53.33%]

Epoch 1/3 [Batch]:   8%|█████▏                                                       | 5/59 [00:08<01:21,  1.51s/it, avg_acc=51.12%]

Epoch 1/3 [Batch]:  10%|██████▏                                                      | 6/59 [00:09<01:17,  1.47s/it, avg_acc=50.31%]
21:54:41 | [WARNING] | [HCSE] 聚类与聚合出现异常，跳过本步: selected index k out of range

Epoch 1/3 [Batch]:  12%|███████▏                                                     | 7/59 [00:10<01:14,  1.43s/it, avg_acc=50.62%]

Epoch 1/3 [Batch]:  15%|█████████▎                                                   | 9/59 [00:13<01:10,  1.41s/it, avg_acc=49.79%]
21:54:45 | [WARNING] | [HCSE] 聚类与聚合出现异常，跳过本步: selected index k out of range

Epoch 1/3 [Batch]:  17%|██████████▏                                                 | 10/59 [00:15<01:08,  1.41s/it, avg_acc=49.19%]

Epoch 1/3 [Batch]:  20%|████████████▏                                               | 12/59 [00:17<01:06,  1.40s/it, avg_acc=49.48%]
21:54:50 | [WARNING] | [HCSE] 聚类与聚合出现异常，跳过本步: selected index k out of range

Epoch 1/3 [Batch]:  22%|█████████████▏                                              | 13/59 [00:19<01:04,  1.40s/it, avg_acc=49.47%]

Epoch 1/3 [Batch]:  25%|███████████████▎                                            | 15/59 [00:22<01:01,  1.40s/it, avg_acc=49.50%]

Epoch 1/3 [Batch]:  27%|████████████████▎                                           | 16/59 [00:23<01:00,  1.41s/it, avg_acc=49.02%]
21:54:55 | [WARNING] | [HCSE] 聚类与聚合出现异常，跳过本步: selected index k out of range

Epoch 1/3 [Batch]:  29%|█████████████████▎                                          | 17/59 [00:24<00:59,  1.41s/it, avg_acc=49.08%]

Traceback (most recent call last):
  File "/date/liuxin/code/dp-fpl/federated_main.py", line 754, in <module>
    main(args)
  File "/date/liuxin/code/dp-fpl/federated_main.py", line 382, in main
    loss_summary = local_trainer.train_forward(idx=idx, train_iter=data_iters[idx], current_batch=batch, total_batches=max_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/code/dp-fpl/trainers/DP_FPL.py", line 480, in train_forward
    loss_summary = self.forward_pass(batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/code/dp-fpl/trainers/DP_FPL.py", line 394, in forward_pass
    logits = self.model(image)
             ^^^^^^^^^^^^^^^^^
  File "/date/liuxin/miniconda3/envs/sepfpl/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/miniconda3/envs/sepfpl/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/code/dp-fpl/trainers/DP_FPL.py", line 242, in forward
    client_text_features = self.text_encoder(client_prompt, tokenized_prompts) # [100,512] = [n_cls, ctx_dim]
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/miniconda3/envs/sepfpl/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/miniconda3/envs/sepfpl/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/code/dp-fpl/trainers/DP_FPL.py", line 126, in forward
    x = x[torch.arange(x.shape[0]), tokenized_prompts.argmax(dim=-1)] @ self.text_projection
                                                                        ^^^^^^^^^^^^^^^^^^^^
  File "/date/liuxin/miniconda3/envs/sepfpl/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1951, in __getattr__
    def __getattr__(self, name: str) -> Union[Tensor, "Module"]:
KeyboardInterrupt