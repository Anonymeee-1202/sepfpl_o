2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Loading trainer: DP_FPL
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Loading dataset: Caltech101
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Reading split from %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Creating a baseline federated dataset
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | class_num %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Creating a baseline federated dataset
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | class_num %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | user class dict total %s
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | idx: %s, output_dict_len: %d
2025-11-21 00:37:06 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 00:37:08 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Building custom CLIP
2025-11-21 00:37:08 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | Turning off gradients in both the image and the text encoder
2025-11-21 00:37:08 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-dpfpl-rank16-noise0.4-seed1-users10-5/120, mode=online
2025-11-21 00:37:38 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 1/30] 训练耗时: 19.07s | 平均训练准确率: 54.55
2025-11-21 00:37:56 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 2/30] 训练耗时: 17.68s | 平均训练准确率: 52.46
2025-11-21 00:38:14 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 3/30] 训练耗时: 17.89s | 平均训练准确率: 53.57
2025-11-21 00:38:33 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 4/30] 训练耗时: 19.12s | 平均训练准确率: 53.57
2025-11-21 00:38:51 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 5/30] 训练耗时: 18.23s | 平均训练准确率: 53.35
2025-11-21 00:39:09 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 6/30] 训练耗时: 18.02s | 平均训练准确率: 54.82
2025-11-21 00:39:28 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 7/30] 训练耗时: 18.80s | 平均训练准确率: 54.29
2025-11-21 00:39:45 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 8/30] 训练耗时: 17.44s | 平均训练准确率: 53.97
2025-11-21 00:40:04 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 9/30] 训练耗时: 18.99s | 平均训练准确率: 53.44
2025-11-21 00:40:23 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 10/30] 训练耗时: 19.02s | 平均训练准确率: 53.48
2025-11-21 00:40:42 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 11/30] 训练耗时: 18.72s | 平均训练准确率: 53.57
2025-11-21 00:41:01 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 12/30] 训练耗时: 18.87s | 平均训练准确率: 54.87
2025-11-21 00:41:19 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 13/30] 训练耗时: 18.46s | 平均训练准确率: 54.20
2025-11-21 00:41:38 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 14/30] 训练耗时: 18.58s | 平均训练准确率: 53.88
2025-11-21 00:41:57 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 15/30] 训练耗时: 18.91s | 平均训练准确率: 53.71
2025-11-21 00:42:15 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 16/30] 训练耗时: 18.51s | 平均训练准确率: 53.48
2025-11-21 00:42:33 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 17/30] 训练耗时: 18.18s | 平均训练准确率: 53.97
2025-11-21 00:42:52 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 18/30] 训练耗时: 18.56s | 平均训练准确率: 52.54
2025-11-21 00:43:10 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 19/30] 训练耗时: 17.97s | 平均训练准确率: 52.54
2025-11-21 00:43:28 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 20/30] 训练耗时: 17.82s | 平均训练准确率: 53.71
2025-11-21 00:43:46 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 21/30] 训练耗时: 18.59s | 平均训练准确率: 55.04
2025-11-21 00:44:05 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 22/30] 训练耗时: 18.16s | 平均训练准确率: 53.75
2025-11-21 00:44:22 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 23/30] 训练耗时: 17.84s | 平均训练准确率: 53.17
2025-11-21 00:44:40 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 24/30] 训练耗时: 17.94s | 平均训练准确率: 53.62
2025-11-21 00:44:58 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 25/30] 训练耗时: 17.98s | 平均训练准确率: 52.95
2025-11-21 00:45:16 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 26/30] 训练耗时: 17.68s | 平均训练准确率: 53.75
2025-11-21 00:45:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 27/30] 训练耗时: 18.65s | 平均训练准确率: 54.20
2025-11-21 00:45:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 28/30] 训练耗时: 18.43s | 平均训练准确率: 52.37
2025-11-21 00:45:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:45:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:45:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     TEST START - Epoch 28/30
2025-11-21 00:45:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:45:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    21.80 |      78.20 |    46.85 |
| Client 1 |    81.25 |      18.75 |    86.28 |
| Client 2 |    64.94 |      35.06 |    65.01 |
| Client 3 |    59.26 |      40.74 |    63.30 |
| Client 4 |    79.64 |      20.36 |    74.94 |
| Client 5 |    87.26 |      12.74 |    90.94 |
| Client 6 |    47.37 |      52.63 |    53.34 |
| Client 7 |    89.36 |      10.64 |    76.09 |
| Client 8 |    83.13 |      16.87 |    63.19 |
| Client 9 |    82.52 |      17.48 |    78.53 |
| Average  |    69.65 |      30.35 |    69.85 |
+----------+----------+------------+----------+

2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    78.85 |      21.15 |    66.54 |
| Client 1 |    68.59 |      31.41 |    59.34 |
| Client 2 |    69.62 |      30.38 |    62.75 |
| Client 3 |    69.87 |      30.13 |    60.79 |
| Client 4 |    67.87 |      32.13 |    58.89 |
| Client 5 |    67.42 |      32.58 |    58.26 |
| Client 6 |    69.88 |      30.12 |    61.04 |
| Client 7 |    64.14 |      35.86 |    59.39 |
| Client 8 |    65.22 |      34.78 |    60.06 |
| Client 9 |    66.89 |      33.11 |    58.60 |
| Average  |    68.83 |      31.17 |    60.57 |
+----------+----------+------------+----------+

2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     TEST FINISH - Epoch 28/30
2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     测试耗时: 138.75s
2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:48:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:48:30 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 29/30] 训练耗时: 18.50s | 平均训练准确率: 62.01
2025-11-21 00:48:30 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:48:30 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:48:30 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     TEST START - Epoch 29/30
2025-11-21 00:48:30 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:48:30 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    37.34 |      62.66 |    60.62 |
| Client 1 |    92.61 |       7.39 |    94.45 |
| Client 2 |    69.48 |      30.52 |    73.26 |
| Client 3 |    66.67 |      33.33 |    72.58 |
| Client 4 |    90.05 |       9.95 |    90.99 |
| Client 5 |    94.27 |       5.73 |    95.83 |
| Client 6 |    76.02 |      23.98 |    81.95 |
| Client 7 |    94.55 |       5.45 |    88.41 |
| Client 8 |    95.42 |       4.58 |    93.15 |
| Client 9 |    87.86 |      12.14 |    89.90 |
| Average  |    80.43 |      19.57 |    84.11 |
+----------+----------+------------+----------+

2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    87.22 |      12.78 |    81.42 |
| Client 1 |    78.64 |      21.36 |    76.29 |
| Client 2 |    80.14 |      19.86 |    79.33 |
| Client 3 |    80.33 |      19.67 |    79.17 |
| Client 4 |    78.16 |      21.84 |    77.02 |
| Client 5 |    77.95 |      22.05 |    75.94 |
| Client 6 |    79.12 |      20.88 |    77.64 |
| Client 7 |    75.55 |      24.45 |    76.78 |
| Client 8 |    75.12 |      24.88 |    75.32 |
| Client 9 |    77.60 |      22.40 |    77.12 |
| Average  |    78.98 |      21.02 |    77.60 |
+----------+----------+------------+----------+

2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     TEST FINISH - Epoch 29/30
2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     测试耗时: 142.81s
2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:50:53 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:51:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | [Epoch 30/30] 训练耗时: 18.51s | 平均训练准确率: 70.09
2025-11-21 00:51:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:51:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:51:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     TEST START - Epoch 30/30
2025-11-21 00:51:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:51:12 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    53.38 |      46.62 |    73.25 |
| Client 1 |    95.45 |       4.55 |    96.05 |
| Client 2 |    71.43 |      28.57 |    75.66 |
| Client 3 |    79.01 |      20.99 |    85.52 |
| Client 4 |    89.59 |      10.41 |    88.51 |
| Client 5 |    96.18 |       3.82 |    97.68 |
| Client 6 |    82.46 |      17.54 |    86.58 |
| Client 7 |    98.51 |       1.49 |    97.58 |
| Client 8 |    96.39 |       3.61 |    94.05 |
| Client 9 |    94.17 |       5.83 |    94.40 |
| Average  |    85.66 |      14.34 |    88.93 |
+----------+----------+------------+----------+

2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    91.24 |       8.76 |    86.54 |
| Client 1 |    83.88 |      16.12 |    82.12 |
| Client 2 |    85.24 |      14.76 |    85.22 |
| Client 3 |    84.50 |      15.50 |    83.27 |
| Client 4 |    83.29 |      16.71 |    83.05 |
| Client 5 |    82.54 |      17.46 |    81.93 |
| Client 6 |    83.30 |      16.70 |    82.68 |
| Client 7 |    79.91 |      20.09 |    81.35 |
| Client 8 |    80.24 |      19.76 |    80.99 |
| Client 9 |    81.81 |      18.19 |    82.35 |
| Average  |    83.60 |      16.40 |    82.95 |
+----------+----------+------------+----------+

2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     TEST FINISH - Epoch 30/30
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] |                     测试耗时: 143.48s
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | ================================================================================
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | 
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | maximum test local acc: 85.658
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | mean of local acc: 78.580
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | maximum test neighbor acc: 83.596
2025-11-21 00:53:35 | INFO | caltech-101_dpfpl_16_0.4_10_[5/120] | mean of neighbor acc: 77.137
