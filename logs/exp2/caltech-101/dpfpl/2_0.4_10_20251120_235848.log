2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Loading trainer: DP_FPL
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Loading dataset: Caltech101
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Reading split from %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Creating a baseline federated dataset
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | class_num %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Creating a baseline federated dataset
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | class_num %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | user class dict total %s
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | idx: %s, output_dict_len: %d
2025-11-20 23:58:48 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Loading CLIP (backbone: ViT-B/16)
2025-11-20 23:58:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Building custom CLIP
2025-11-20 23:58:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | Turning off gradients in both the image and the text encoder
2025-11-20 23:58:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-dpfpl-rank2-noise0.4-seed1-users10-2/120, mode=online
2025-11-20 23:59:28 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 1/30] 训练耗时: 20.33s | 平均训练准确率: 53.12
2025-11-20 23:59:47 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 2/30] 训练耗时: 18.72s | 平均训练准确率: 53.53
2025-11-21 00:00:05 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 3/30] 训练耗时: 18.13s | 平均训练准确率: 54.06
2025-11-21 00:00:23 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 4/30] 训练耗时: 18.25s | 平均训练准确率: 53.26
2025-11-21 00:00:41 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 5/30] 训练耗时: 17.82s | 平均训练准确率: 54.15
2025-11-21 00:00:58 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 6/30] 训练耗时: 17.42s | 平均训练准确率: 53.75
2025-11-21 00:01:17 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 7/30] 训练耗时: 18.79s | 平均训练准确率: 53.21
2025-11-21 00:01:35 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 8/30] 训练耗时: 18.21s | 平均训练准确率: 53.84
2025-11-21 00:01:53 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 9/30] 训练耗时: 18.08s | 平均训练准确率: 52.81
2025-11-21 00:02:11 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 10/30] 训练耗时: 17.61s | 平均训练准确率: 53.66
2025-11-21 00:02:29 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 11/30] 训练耗时: 17.81s | 平均训练准确率: 54.87
2025-11-21 00:02:47 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 12/30] 训练耗时: 17.76s | 平均训练准确率: 53.30
2025-11-21 00:03:04 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 13/30] 训练耗时: 17.51s | 平均训练准确率: 53.57
2025-11-21 00:03:22 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 14/30] 训练耗时: 17.70s | 平均训练准确率: 54.55
2025-11-21 00:03:40 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 15/30] 训练耗时: 17.75s | 平均训练准确率: 52.99
2025-11-21 00:03:57 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 16/30] 训练耗时: 17.63s | 平均训练准确率: 53.26
2025-11-21 00:04:14 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 17/30] 训练耗时: 17.35s | 平均训练准确率: 52.59
2025-11-21 00:04:32 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 18/30] 训练耗时: 17.45s | 平均训练准确率: 54.46
2025-11-21 00:04:50 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 19/30] 训练耗时: 18.14s | 平均训练准确率: 54.96
2025-11-21 00:05:08 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 20/30] 训练耗时: 17.73s | 平均训练准确率: 55.31
2025-11-21 00:05:26 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 21/30] 训练耗时: 18.08s | 平均训练准确率: 53.75
2025-11-21 00:05:44 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 22/30] 训练耗时: 17.67s | 平均训练准确率: 53.75
2025-11-21 00:06:01 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 23/30] 训练耗时: 17.54s | 平均训练准确率: 53.04
2025-11-21 00:06:19 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 24/30] 训练耗时: 17.64s | 平均训练准确率: 54.33
2025-11-21 00:06:37 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 25/30] 训练耗时: 17.79s | 平均训练准确率: 53.57
2025-11-21 00:06:54 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 26/30] 训练耗时: 17.89s | 平均训练准确率: 53.39
2025-11-21 00:07:12 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 27/30] 训练耗时: 17.63s | 平均训练准确率: 53.88
2025-11-21 00:07:30 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 28/30] 训练耗时: 17.71s | 平均训练准确率: 54.55
2025-11-21 00:07:30 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:07:30 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:07:30 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     TEST START - Epoch 28/30
2025-11-21 00:07:30 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:07:30 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    21.80 |      78.20 |    45.08 |
| Client 1 |    75.57 |      24.43 |    81.61 |
| Client 2 |    64.94 |      35.06 |    65.01 |
| Client 3 |    59.88 |      40.12 |    62.84 |
| Client 4 |    78.28 |      21.72 |    72.50 |
| Client 5 |    86.62 |      13.38 |    90.25 |
| Client 6 |    46.20 |      53.80 |    52.96 |
| Client 7 |    88.61 |      11.39 |    75.42 |
| Client 8 |    83.37 |      16.63 |    63.82 |
| Client 9 |    82.52 |      17.48 |    79.16 |
| Average  |    68.78 |      31.22 |    68.87 |
+----------+----------+------------+----------+

2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    77.44 |      22.56 |    64.70 |
| Client 1 |    67.85 |      32.15 |    58.14 |
| Client 2 |    68.41 |      31.59 |    60.60 |
| Client 3 |    68.56 |      31.44 |    59.14 |
| Client 4 |    66.84 |      33.16 |    57.53 |
| Client 5 |    66.55 |      33.45 |    57.30 |
| Client 6 |    69.35 |      30.65 |    60.08 |
| Client 7 |    63.56 |      36.44 |    58.39 |
| Client 8 |    64.34 |      35.66 |    58.53 |
| Client 9 |    66.09 |      33.91 |    57.01 |
| Average  |    67.90 |      32.10 |    59.14 |
+----------+----------+------------+----------+

2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     TEST FINISH - Epoch 28/30
2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     测试耗时: 145.79s
2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:09:56 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:10:13 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 29/30] 训练耗时: 17.85s | 平均训练准确率: 59.55
2025-11-21 00:10:13 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:10:13 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:10:13 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     TEST START - Epoch 29/30
2025-11-21 00:10:13 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:10:13 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    43.11 |      56.89 |    61.42 |
| Client 1 |    93.18 |       6.82 |    95.01 |
| Client 2 |    68.18 |      31.82 |    72.25 |
| Client 3 |    64.81 |      35.19 |    67.17 |
| Client 4 |    84.16 |      15.84 |    84.68 |
| Client 5 |    93.63 |       6.37 |    95.78 |
| Client 6 |    62.57 |      37.43 |    68.16 |
| Client 7 |    92.82 |       7.18 |    84.51 |
| Client 8 |    93.98 |       6.02 |    92.12 |
| Client 9 |    88.35 |      11.65 |    89.89 |
| Average  |    78.48 |      21.52 |    81.10 |
+----------+----------+------------+----------+

2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    85.82 |      14.18 |    79.30 |
| Client 1 |    77.54 |      22.46 |    73.39 |
| Client 2 |    78.97 |      21.03 |    75.80 |
| Client 3 |    79.07 |      20.93 |    75.78 |
| Client 4 |    77.54 |      22.46 |    73.35 |
| Client 5 |    76.91 |      23.09 |    72.28 |
| Client 6 |    78.81 |      21.19 |    75.27 |
| Client 7 |    74.43 |      25.57 |    73.21 |
| Client 8 |    74.10 |      25.90 |    71.40 |
| Client 9 |    76.32 |      23.68 |    72.92 |
| Average  |    77.95 |      22.05 |    74.27 |
+----------+----------+------------+----------+

2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     TEST FINISH - Epoch 29/30
2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     测试耗时: 139.48s
2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:12:33 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:12:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | [Epoch 30/30] 训练耗时: 17.81s | 平均训练准确率: 69.87
2025-11-21 00:12:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:12:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:12:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     TEST START - Epoch 30/30
2025-11-21 00:12:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:12:51 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    49.87 |      50.13 |    72.07 |
| Client 1 |    93.75 |       6.25 |    94.18 |
| Client 2 |    70.78 |      29.22 |    74.94 |
| Client 3 |    79.63 |      20.37 |    86.94 |
| Client 4 |    90.05 |       9.95 |    88.55 |
| Client 5 |    94.90 |       5.10 |    96.75 |
| Client 6 |    80.12 |      19.88 |    85.11 |
| Client 7 |    98.51 |       1.49 |    97.49 |
| Client 8 |    96.63 |       3.37 |    95.40 |
| Client 9 |    93.69 |       6.31 |    95.39 |
| Average  |    84.79 |      15.21 |    88.68 |
+----------+----------+------------+----------+

2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    91.14 |       8.86 |    86.60 |
| Client 1 |    83.27 |      16.73 |    81.93 |
| Client 2 |    84.81 |      15.19 |    84.52 |
| Client 3 |    84.02 |      15.98 |    82.27 |
| Client 4 |    82.84 |      17.16 |    82.30 |
| Client 5 |    82.32 |      17.68 |    81.17 |
| Client 6 |    83.17 |      16.83 |    81.78 |
| Client 7 |    79.72 |      20.28 |    80.41 |
| Client 8 |    79.51 |      20.49 |    79.36 |
| Client 9 |    81.36 |      18.64 |    80.68 |
| Average  |    83.22 |      16.78 |    82.10 |
+----------+----------+------------+----------+

2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     TEST FINISH - Epoch 30/30
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] |                     测试耗时: 139.24s
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | ================================================================================
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | 
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | maximum test local acc: 84.793
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | mean of local acc: 77.351
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | maximum test neighbor acc: 83.218
2025-11-21 00:15:10 | INFO | caltech-101_dpfpl_2_0.4_10_[2/120] | mean of neighbor acc: 76.357
