2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Loading trainer: DP_FPL
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Loading dataset: Caltech101
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Reading split from %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Creating a baseline federated dataset
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | class_num %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Creating a baseline federated dataset
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | class_num %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | user class dict total %s
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | idx: %s, output_dict_len: %d
2025-11-21 20:56:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 20:56:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Building custom CLIP
2025-11-21 20:56:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | Turning off gradients in both the image and the text encoder
2025-11-21 20:56:03 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank8-noise0.1-seed1-users10-17/60, mode=offline
2025-11-21 20:56:25 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 1/30] 训练耗时: 19.30s | 平均训练准确率: 66.61
2025-11-21 20:56:42 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 2/30] 训练耗时: 17.51s | 平均训练准确率: 67.32
2025-11-21 20:57:00 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 3/30] 训练耗时: 17.68s | 平均训练准确率: 66.70
2025-11-21 20:57:18 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 4/30] 训练耗时: 17.70s | 平均训练准确率: 66.12
2025-11-21 20:57:37 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 5/30] 训练耗时: 19.08s | 平均训练准确率: 66.34
2025-11-21 20:57:55 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 6/30] 训练耗时: 18.21s | 平均训练准确率: 66.83
2025-11-21 20:58:13 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 7/30] 训练耗时: 17.69s | 平均训练准确率: 66.65
2025-11-21 20:58:30 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 8/30] 训练耗时: 17.71s | 平均训练准确率: 67.41
2025-11-21 20:58:48 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 9/30] 训练耗时: 17.40s | 平均训练准确率: 65.54
2025-11-21 20:59:06 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 10/30] 训练耗时: 18.44s | 平均训练准确率: 67.50
2025-11-21 20:59:24 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 11/30] 训练耗时: 17.82s | 平均训练准确率: 66.61
2025-11-21 20:59:43 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 12/30] 训练耗时: 18.77s | 平均训练准确率: 66.96
2025-11-21 21:00:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 13/30] 训练耗时: 18.83s | 平均训练准确率: 65.76
2025-11-21 21:00:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 14/30] 训练耗时: 17.87s | 平均训练准确率: 66.65
2025-11-21 21:00:37 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 15/30] 训练耗时: 17.62s | 平均训练准确率: 65.36
2025-11-21 21:00:55 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 16/30] 训练耗时: 18.11s | 平均训练准确率: 67.01
2025-11-21 21:01:13 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 17/30] 训练耗时: 18.17s | 平均训练准确率: 66.61
2025-11-21 21:01:32 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 18/30] 训练耗时: 18.91s | 平均训练准确率: 67.41
2025-11-21 21:01:51 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 19/30] 训练耗时: 18.70s | 平均训练准确率: 67.81
2025-11-21 21:02:10 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 20/30] 训练耗时: 19.03s | 平均训练准确率: 67.72
2025-11-21 21:02:29 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 21/30] 训练耗时: 18.69s | 平均训练准确率: 66.38
2025-11-21 21:02:47 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 22/30] 训练耗时: 18.83s | 平均训练准确率: 67.54
2025-11-21 21:03:06 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 23/30] 训练耗时: 18.75s | 平均训练准确率: 66.29
2025-11-21 21:03:25 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 24/30] 训练耗时: 18.47s | 平均训练准确率: 67.01
2025-11-21 21:03:43 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 25/30] 训练耗时: 18.13s | 平均训练准确率: 67.77
2025-11-21 21:04:01 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 26/30] 训练耗时: 18.39s | 平均训练准确率: 66.34
2025-11-21 21:04:20 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 27/30] 训练耗时: 18.55s | 平均训练准确率: 66.47
2025-11-21 21:04:41 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 28/30] 训练耗时: 21.09s | 平均训练准确率: 66.16
2025-11-21 21:04:41 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:04:41 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:04:41 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     TEST START - Epoch 28/30
2025-11-21 21:04:41 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:04:41 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    57.89 |      42.11 |    76.32 |
| Client 1 |    92.61 |       7.39 |    92.20 |
| Client 2 |    68.18 |      31.82 |    72.12 |
| Client 3 |    80.86 |      19.14 |    81.68 |
| Client 4 |    90.50 |       9.50 |    91.17 |
| Client 5 |    85.35 |      14.65 |    86.43 |
| Client 6 |    73.68 |      26.32 |    79.74 |
| Client 7 |    90.10 |       9.90 |    77.77 |
| Client 8 |    88.67 |      11.33 |    80.79 |
| Client 9 |    84.47 |      15.53 |    82.19 |
| Average  |    81.23 |      18.77 |    82.04 |
+----------+----------+------------+----------+

2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    87.27 |      12.73 |    79.79 |
| Client 1 |    80.82 |      19.18 |    74.96 |
| Client 2 |    83.04 |      16.96 |    77.73 |
| Client 3 |    82.20 |      17.80 |    76.71 |
| Client 4 |    81.55 |      18.45 |    75.71 |
| Client 5 |    80.85 |      19.15 |    74.58 |
| Client 6 |    81.56 |      18.44 |    74.82 |
| Client 7 |    78.17 |      21.83 |    74.01 |
| Client 8 |    78.34 |      21.66 |    73.50 |
| Client 9 |    79.64 |      20.36 |    74.41 |
| Average  |    81.34 |      18.66 |    75.62 |
+----------+----------+------------+----------+

2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     测试耗时: 147.97s
2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:07:09 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:07:28 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 29/30] 训练耗时: 18.71s | 平均训练准确率: 70.85
2025-11-21 21:07:28 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:07:28 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:07:28 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     TEST START - Epoch 29/30
2025-11-21 21:07:28 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:07:28 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    69.67 |      30.33 |    82.75 |
| Client 1 |    93.18 |       6.82 |    93.65 |
| Client 2 |    65.58 |      34.42 |    67.99 |
| Client 3 |    82.72 |      17.28 |    83.77 |
| Client 4 |    91.86 |       8.14 |    91.21 |
| Client 5 |    94.27 |       5.73 |    96.22 |
| Client 6 |    82.46 |      17.54 |    86.22 |
| Client 7 |    95.54 |       4.46 |    91.22 |
| Client 8 |    95.42 |       4.58 |    92.96 |
| Client 9 |    93.20 |       6.80 |    92.78 |
| Average  |    86.39 |      13.61 |    87.88 |
+----------+----------+------------+----------+

2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.17 |       9.83 |    84.27 |
| Client 1 |    85.85 |      14.15 |    81.47 |
| Client 2 |    87.88 |      12.12 |    84.30 |
| Client 3 |    86.67 |      13.33 |    82.98 |
| Client 4 |    85.87 |      14.13 |    82.08 |
| Client 5 |    85.88 |      14.12 |    81.85 |
| Client 6 |    86.70 |      13.30 |    83.10 |
| Client 7 |    84.33 |      15.67 |    81.82 |
| Client 8 |    83.46 |      16.54 |    80.39 |
| Client 9 |    85.21 |      14.79 |    82.40 |
| Average  |    86.20 |      13.80 |    82.47 |
+----------+----------+------------+----------+

2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     测试耗时: 136.67s
2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:09:44 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:10:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | [Epoch 30/30] 训练耗时: 17.45s | 平均训练准确率: 75.94
2025-11-21 21:10:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:10:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:10:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     TEST START - Epoch 30/30
2025-11-21 21:10:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:10:02 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    72.68 |      27.32 |    82.98 |
| Client 1 |    91.48 |       8.52 |    89.29 |
| Client 2 |    66.23 |      33.77 |    68.75 |
| Client 3 |    81.48 |      18.52 |    82.27 |
| Client 4 |    90.95 |       9.05 |    89.90 |
| Client 5 |    95.54 |       4.46 |    97.14 |
| Client 6 |    81.87 |      18.13 |    86.27 |
| Client 7 |    95.05 |       4.95 |    90.97 |
| Client 8 |    91.81 |       8.19 |    86.33 |
| Client 9 |    93.69 |       6.31 |    94.29 |
| Average  |    86.08 |      13.92 |    86.82 |
+----------+----------+------------+----------+

2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    87.71 |      12.29 |    80.20 |
| Client 1 |    85.93 |      14.07 |    80.52 |
| Client 2 |    88.19 |      11.81 |    84.26 |
| Client 3 |    87.19 |      12.81 |    82.59 |
| Client 4 |    86.68 |      13.32 |    82.22 |
| Client 5 |    84.49 |      15.51 |    80.20 |
| Client 6 |    85.75 |      14.25 |    81.41 |
| Client 7 |    82.92 |      17.08 |    80.32 |
| Client 8 |    83.32 |      16.68 |    80.74 |
| Client 9 |    84.02 |      15.98 |    80.86 |
| Average  |    85.62 |      14.38 |    81.33 |
+----------+----------+------------+----------+

2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] |                     测试耗时: 137.53s
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | ================================================================================
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | 
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | maximum test local acc: 86.391
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | mean of local acc: 84.567
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | maximum test neighbor acc: 86.203
2025-11-21 21:12:19 | INFO | caltech-101_sepfpl_hcse_8_0.1_10_[17/60] | mean of neighbor acc: 84.388
