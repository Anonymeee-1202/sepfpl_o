2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Loading trainer: DP_FPL
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Loading dataset: Caltech101
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Reading split from %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Creating a baseline federated dataset
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | class_num %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Creating a baseline federated dataset
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | class_num %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | user class dict total %s
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | idx: %s, output_dict_len: %d
2025-11-21 19:28:07 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 19:28:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Building custom CLIP
2025-11-21 19:28:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | Turning off gradients in both the image and the text encoder
2025-11-21 19:28:10 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank16-noise0.4-seed1-users10-9/60, mode=offline
2025-11-21 19:28:44 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 1/30] 训练耗时: 31.20s | 平均训练准确率: 65.71
2025-11-21 19:29:14 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 2/30] 训练耗时: 29.80s | 平均训练准确率: 66.29
2025-11-21 19:29:42 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 3/30] 训练耗时: 28.54s | 平均训练准确率: 67.05
2025-11-21 19:30:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 4/30] 训练耗时: 26.55s | 平均训练准确率: 66.92
2025-11-21 19:30:36 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 5/30] 训练耗时: 26.77s | 平均训练准确率: 67.28
2025-11-21 19:31:05 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 6/30] 训练耗时: 29.54s | 平均训练准确率: 66.70
2025-11-21 19:31:35 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 7/30] 训练耗时: 29.50s | 平均训练准确率: 66.96
2025-11-21 19:32:04 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 8/30] 训练耗时: 29.14s | 平均训练准确率: 66.38
2025-11-21 19:32:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 9/30] 训练耗时: 29.61s | 平均训练准确率: 67.14
2025-11-21 19:33:03 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 10/30] 训练耗时: 29.56s | 平均训练准确率: 66.47
2025-11-21 19:33:28 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 11/30] 训练耗时: 24.61s | 平均训练准确率: 67.23
2025-11-21 19:33:56 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 12/30] 训练耗时: 28.05s | 平均训练准确率: 66.79
2025-11-21 19:34:25 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 13/30] 训练耗时: 28.88s | 平均训练准确率: 65.76
2025-11-21 19:34:52 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 14/30] 训练耗时: 26.97s | 平均训练准确率: 68.48
2025-11-21 19:35:20 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 15/30] 训练耗时: 28.43s | 平均训练准确率: 68.08
2025-11-21 19:35:49 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 16/30] 训练耗时: 28.73s | 平均训练准确率: 68.17
2025-11-21 19:36:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 17/30] 训练耗时: 29.55s | 平均训练准确率: 65.54
2025-11-21 19:36:41 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 18/30] 训练耗时: 22.37s | 平均训练准确率: 66.12
2025-11-21 19:37:04 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 19/30] 训练耗时: 23.52s | 平均训练准确率: 66.88
2025-11-21 19:37:27 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 20/30] 训练耗时: 23.26s | 平均训练准确率: 66.47
2025-11-21 19:37:50 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 21/30] 训练耗时: 23.01s | 平均训练准确率: 66.43
2025-11-21 19:38:14 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 22/30] 训练耗时: 23.18s | 平均训练准确率: 66.56
2025-11-21 19:38:37 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 23/30] 训练耗时: 23.07s | 平均训练准确率: 67.19
2025-11-21 19:38:59 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 24/30] 训练耗时: 22.75s | 平均训练准确率: 65.98
2025-11-21 19:39:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 25/30] 训练耗时: 23.34s | 平均训练准确率: 65.98
2025-11-21 19:39:47 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 26/30] 训练耗时: 23.80s | 平均训练准确率: 67.68
2025-11-21 19:40:10 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 27/30] 训练耗时: 23.37s | 平均训练准确率: 66.79
2025-11-21 19:40:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 28/30] 训练耗时: 23.28s | 平均训练准确率: 65.76
2025-11-21 19:40:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:40:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:40:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     TEST START - Epoch 28/30
2025-11-21 19:40:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:40:33 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.40 |      41.60 |    77.14 |
| Client 1 |    91.48 |       8.52 |    89.53 |
| Client 2 |    68.18 |      31.82 |    72.18 |
| Client 3 |    79.63 |      20.37 |    80.49 |
| Client 4 |    93.21 |       6.79 |    94.07 |
| Client 5 |    85.99 |      14.01 |    86.75 |
| Client 6 |    71.93 |      28.07 |    77.61 |
| Client 7 |    89.85 |      10.15 |    76.95 |
| Client 8 |    91.33 |       8.67 |    85.68 |
| Client 9 |    84.47 |      15.53 |    82.19 |
| Average  |    81.45 |      18.55 |    82.26 |
+----------+----------+------------+----------+

2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    86.98 |      13.02 |    79.34 |
| Client 1 |    81.13 |      18.87 |    75.32 |
| Client 2 |    82.69 |      17.31 |    77.15 |
| Client 3 |    82.20 |      17.80 |    76.68 |
| Client 4 |    80.93 |      19.07 |    74.90 |
| Client 5 |    81.28 |      18.72 |    75.25 |
| Client 6 |    82.17 |      17.83 |    75.70 |
| Client 7 |    79.33 |      20.67 |    75.04 |
| Client 8 |    79.02 |      20.98 |    73.96 |
| Client 9 |    80.88 |      19.12 |    75.97 |
| Average  |    81.66 |      18.34 |    75.93 |
+----------+----------+------------+----------+

2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     测试耗时: 192.86s
2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:43:46 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:44:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 29/30] 训练耗时: 23.16s | 平均训练准确率: 71.25
2025-11-21 19:44:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:44:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:44:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     TEST START - Epoch 29/30
2025-11-21 19:44:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:44:09 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    71.43 |      28.57 |    83.92 |
| Client 1 |    93.75 |       6.25 |    94.00 |
| Client 2 |    70.78 |      29.22 |    73.97 |
| Client 3 |    83.95 |      16.05 |    83.89 |
| Client 4 |    91.40 |       8.60 |    90.74 |
| Client 5 |    96.18 |       3.82 |    97.17 |
| Client 6 |    85.96 |      14.04 |    90.00 |
| Client 7 |    95.79 |       4.21 |    92.47 |
| Client 8 |    97.83 |       2.17 |    96.77 |
| Client 9 |    92.72 |       7.28 |    92.00 |
| Average  |    87.98 |      12.02 |    89.49 |
+----------+----------+------------+----------+

2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.95 |       9.05 |    85.68 |
| Client 1 |    87.55 |      12.45 |    83.69 |
| Client 2 |    89.18 |      10.82 |    86.24 |
| Client 3 |    88.06 |      11.94 |    84.87 |
| Client 4 |    86.99 |      13.01 |    83.97 |
| Client 5 |    87.18 |      12.82 |    83.88 |
| Client 6 |    87.88 |      12.12 |    84.84 |
| Client 7 |    85.98 |      14.02 |    83.95 |
| Client 8 |    85.27 |      14.73 |    82.89 |
| Client 9 |    86.85 |      13.15 |    84.51 |
| Average  |    87.59 |      12.41 |    84.45 |
+----------+----------+------------+----------+

2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     测试耗时: 194.11s
2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:47:23 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:47:51 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | [Epoch 30/30] 训练耗时: 27.62s | 平均训练准确率: 76.43
2025-11-21 19:47:51 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:47:51 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:47:51 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     TEST START - Epoch 30/30
2025-11-21 19:47:51 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:47:51 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    71.43 |      28.57 |    83.90 |
| Client 1 |    91.48 |       8.52 |    89.23 |
| Client 2 |    63.64 |      36.36 |    64.60 |
| Client 3 |    85.19 |      14.81 |    85.89 |
| Client 4 |    88.24 |      11.76 |    86.94 |
| Client 5 |    97.45 |       2.55 |    97.95 |
| Client 6 |    84.80 |      15.20 |    88.93 |
| Client 7 |    96.04 |       3.96 |    93.72 |
| Client 8 |    91.33 |       8.67 |    85.81 |
| Client 9 |    95.63 |       4.37 |    96.52 |
| Average  |    86.52 |      13.48 |    87.35 |
+----------+----------+------------+----------+

2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    89.50 |      10.50 |    83.03 |
| Client 1 |    85.71 |      14.29 |    80.77 |
| Client 2 |    88.45 |      11.55 |    85.23 |
| Client 3 |    87.19 |      12.81 |    82.44 |
| Client 4 |    86.45 |      13.55 |    82.11 |
| Client 5 |    85.70 |      14.30 |    81.04 |
| Client 6 |    87.23 |      12.77 |    82.64 |
| Client 7 |    85.10 |      14.90 |    81.67 |
| Client 8 |    86.24 |      13.76 |    82.88 |
| Client 9 |    86.85 |      13.15 |    83.68 |
| Average  |    86.84 |      13.16 |    82.55 |
+----------+----------+------------+----------+

2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] |                     测试耗时: 206.91s
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | ================================================================================
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | 
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | maximum test local acc: 87.980
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | mean of local acc: 85.315
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | maximum test neighbor acc: 87.588
2025-11-21 19:51:18 | INFO | caltech-101_sepfpl_hcse_16_0.4_10_[9/60] | mean of neighbor acc: 85.364
