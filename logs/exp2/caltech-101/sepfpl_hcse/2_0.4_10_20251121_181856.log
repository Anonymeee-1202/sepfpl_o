2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Loading trainer: DP_FPL
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Loading dataset: Caltech101
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Reading split from %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Creating a baseline federated dataset
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | class_num %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Creating a baseline federated dataset
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | class_num %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | user class dict total %s
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | idx: %s, output_dict_len: %d
2025-11-21 18:18:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 18:18:58 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Building custom CLIP
2025-11-21 18:18:58 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | Turning off gradients in both the image and the text encoder
2025-11-21 18:18:58 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank2-noise0.4-seed1-users10-3/60, mode=offline
2025-11-21 18:19:26 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 1/30] 训练耗时: 24.88s | 平均训练准确率: 66.34
2025-11-21 18:19:50 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 2/30] 训练耗时: 24.21s | 平均训练准确率: 66.96
2025-11-21 18:20:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 3/30] 训练耗时: 24.26s | 平均训练准确率: 67.05
2025-11-21 18:20:37 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 4/30] 训练耗时: 22.42s | 平均训练准确率: 67.37
2025-11-21 18:21:00 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 5/30] 训练耗时: 23.06s | 平均训练准确率: 67.23
2025-11-21 18:21:23 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 6/30] 训练耗时: 22.93s | 平均训练准确率: 67.19
2025-11-21 18:21:48 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 7/30] 训练耗时: 24.87s | 平均训练准确率: 65.40
2025-11-21 18:22:12 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 8/30] 训练耗时: 23.68s | 平均训练准确率: 67.68
2025-11-21 18:22:35 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 9/30] 训练耗时: 23.83s | 平均训练准确率: 65.27
2025-11-21 18:22:59 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 10/30] 训练耗时: 23.48s | 平均训练准确率: 65.98
2025-11-21 18:23:26 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 11/30] 训练耗时: 27.12s | 平均训练准确率: 67.01
2025-11-21 18:23:51 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 12/30] 训练耗时: 24.76s | 平均训练准确率: 65.94
2025-11-21 18:24:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 13/30] 训练耗时: 24.06s | 平均训练准确率: 66.34
2025-11-21 18:24:40 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 14/30] 训练耗时: 25.51s | 平均训练准确率: 67.99
2025-11-21 18:25:04 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 15/30] 训练耗时: 23.84s | 平均训练准确率: 66.43
2025-11-21 18:25:28 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 16/30] 训练耗时: 24.34s | 平均训练准确率: 66.74
2025-11-21 18:25:54 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 17/30] 训练耗时: 25.52s | 平均训练准确率: 66.56
2025-11-21 18:26:23 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 18/30] 训练耗时: 29.33s | 平均训练准确率: 66.21
2025-11-21 18:26:52 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 19/30] 训练耗时: 28.89s | 平均训练准确率: 66.88
2025-11-21 18:27:22 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 20/30] 训练耗时: 29.96s | 平均训练准确率: 66.38
2025-11-21 18:27:54 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 21/30] 训练耗时: 31.44s | 平均训练准确率: 68.44
2025-11-21 18:28:24 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 22/30] 训练耗时: 30.19s | 平均训练准确率: 67.05
2025-11-21 18:28:55 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 23/30] 训练耗时: 31.67s | 平均训练准确率: 66.74
2025-11-21 18:29:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 24/30] 训练耗时: 25.85s | 平均训练准确率: 66.52
2025-11-21 18:29:49 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 25/30] 训练耗时: 27.52s | 平均训练准确率: 66.88
2025-11-21 18:30:18 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 26/30] 训练耗时: 29.54s | 平均训练准确率: 66.70
2025-11-21 18:30:47 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 27/30] 训练耗时: 28.40s | 平均训练准确率: 68.21
2025-11-21 18:31:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 28/30] 训练耗时: 28.69s | 平均训练准确率: 66.74
2025-11-21 18:31:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:31:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:31:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     TEST START - Epoch 28/30
2025-11-21 18:31:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:31:15 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.40 |      41.60 |    76.89 |
| Client 1 |    91.48 |       8.52 |    89.53 |
| Client 2 |    68.18 |      31.82 |    72.17 |
| Client 3 |    80.86 |      19.14 |    81.68 |
| Client 4 |    93.67 |       6.33 |    94.70 |
| Client 5 |    85.35 |      14.65 |    86.43 |
| Client 6 |    72.51 |      27.49 |    78.04 |
| Client 7 |    90.10 |       9.90 |    78.35 |
| Client 8 |    90.12 |       9.88 |    82.87 |
| Client 9 |    83.98 |      16.02 |    81.53 |
| Average  |    81.46 |      18.54 |    82.22 |
+----------+----------+------------+----------+

2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    87.17 |      12.83 |    79.76 |
| Client 1 |    81.26 |      18.74 |    75.69 |
| Client 2 |    82.86 |      17.14 |    77.56 |
| Client 3 |    82.07 |      17.93 |    76.62 |
| Client 4 |    81.02 |      18.98 |    75.12 |
| Client 5 |    81.07 |      18.93 |    74.90 |
| Client 6 |    82.04 |      17.96 |    75.66 |
| Client 7 |    78.89 |      21.11 |    74.36 |
| Client 8 |    78.88 |      21.12 |    73.87 |
| Client 9 |    80.39 |      19.61 |    75.00 |
| Average  |    81.56 |      18.44 |    75.85 |
+----------+----------+------------+----------+

2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     测试耗时: 203.46s
2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:34:39 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:35:10 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 29/30] 训练耗时: 30.90s | 平均训练准确率: 71.16
2025-11-21 18:35:10 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:35:10 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:35:10 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     TEST START - Epoch 29/30
2025-11-21 18:35:10 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:35:10 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    70.68 |      29.32 |    83.21 |
| Client 1 |    92.61 |       7.39 |    92.69 |
| Client 2 |    66.88 |      33.12 |    69.43 |
| Client 3 |    83.95 |      16.05 |    84.85 |
| Client 4 |    90.50 |       9.50 |    90.07 |
| Client 5 |    95.54 |       4.46 |    97.02 |
| Client 6 |    84.80 |      15.20 |    88.27 |
| Client 7 |    96.53 |       3.47 |    93.93 |
| Client 8 |    97.35 |       2.65 |    96.16 |
| Client 9 |    94.66 |       5.34 |    96.01 |
| Average  |    87.35 |      12.65 |    89.16 |
+----------+----------+------------+----------+

2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.13 |       9.87 |    84.32 |
| Client 1 |    86.54 |      13.46 |    82.64 |
| Client 2 |    88.40 |      11.60 |    85.02 |
| Client 3 |    87.02 |      12.98 |    83.58 |
| Client 4 |    86.59 |      13.41 |    83.54 |
| Client 5 |    86.57 |      13.43 |    83.17 |
| Client 6 |    87.36 |      12.64 |    84.13 |
| Client 7 |    85.25 |      14.75 |    83.30 |
| Client 8 |    84.98 |      15.02 |    82.71 |
| Client 9 |    86.28 |      13.72 |    83.55 |
| Average  |    86.91 |      13.09 |    83.60 |
+----------+----------+------------+----------+

2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     测试耗时: 191.42s
2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:38:21 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:38:45 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | [Epoch 30/30] 训练耗时: 23.36s | 平均训练准确率: 76.56
2025-11-21 18:38:45 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:38:45 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:38:45 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     TEST START - Epoch 30/30
2025-11-21 18:38:45 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:38:45 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    69.92 |      30.08 |    82.90 |
| Client 1 |    94.32 |       5.68 |    94.19 |
| Client 2 |    67.53 |      32.47 |    70.36 |
| Client 3 |    89.51 |      10.49 |    91.26 |
| Client 4 |    93.21 |       6.79 |    92.57 |
| Client 5 |    96.18 |       3.82 |    97.17 |
| Client 6 |    86.55 |      13.45 |    90.37 |
| Client 7 |    95.30 |       4.70 |    92.74 |
| Client 8 |    96.87 |       3.13 |    95.49 |
| Client 9 |    95.15 |       4.85 |    94.91 |
| Average  |    88.45 |      11.55 |    90.20 |
+----------+----------+------------+----------+

2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    91.97 |       8.03 |    87.65 |
| Client 1 |    87.42 |      12.58 |    84.26 |
| Client 2 |    90.13 |       9.87 |    87.95 |
| Client 3 |    88.97 |      11.03 |    85.65 |
| Client 4 |    88.59 |      11.41 |    85.58 |
| Client 5 |    88.39 |      11.61 |    85.35 |
| Client 6 |    89.15 |      10.85 |    85.93 |
| Client 7 |    87.43 |      12.57 |    84.98 |
| Client 8 |    87.22 |      12.78 |    84.57 |
| Client 9 |    88.22 |      11.78 |    85.80 |
| Average  |    88.75 |      11.25 |    85.77 |
+----------+----------+------------+----------+

2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] |                     测试耗时: 191.61s
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | ================================================================================
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | 
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | maximum test local acc: 88.453
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | mean of local acc: 85.756
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | maximum test neighbor acc: 88.749
2025-11-21 18:41:56 | INFO | caltech-101_sepfpl_hcse_2_0.4_10_[3/60] | mean of neighbor acc: 85.741
