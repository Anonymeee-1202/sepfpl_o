2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Loading trainer: DP_FPL
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Loading dataset: Caltech101
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Reading split from %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Creating a baseline federated dataset
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | class_num %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Creating a baseline federated dataset
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | class_num %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | user class dict total %s
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | idx: %s, output_dict_len: %d
2025-11-21 21:34:28 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 21:34:30 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Building custom CLIP
2025-11-21 21:34:30 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | Turning off gradients in both the image and the text encoder
2025-11-21 21:34:30 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank1-noise0.01-seed1-users10-21/60, mode=offline
2025-11-21 21:34:58 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 1/30] 训练耗时: 25.00s | 平均训练准确率: 67.59
2025-11-21 21:35:22 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 2/30] 训练耗时: 23.60s | 平均训练准确率: 67.46
2025-11-21 21:35:45 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 3/30] 训练耗时: 22.68s | 平均训练准确率: 65.76
2025-11-21 21:36:08 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 4/30] 训练耗时: 23.60s | 平均训练准确率: 66.52
2025-11-21 21:36:32 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 5/30] 训练耗时: 23.40s | 平均训练准确率: 68.04
2025-11-21 21:36:55 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 6/30] 训练耗时: 22.96s | 平均训练准确率: 67.14
2025-11-21 21:37:18 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 7/30] 训练耗时: 23.86s | 平均训练准确率: 65.71
2025-11-21 21:37:42 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 8/30] 训练耗时: 23.20s | 平均训练准确率: 66.79
2025-11-21 21:38:05 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 9/30] 训练耗时: 23.10s | 平均训练准确率: 66.16
2025-11-21 21:38:29 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 10/30] 训练耗时: 24.76s | 平均训练准确率: 66.03
2025-11-21 21:39:00 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 11/30] 训练耗时: 31.02s | 平均训练准确率: 65.85
2025-11-21 21:39:30 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 12/30] 训练耗时: 29.35s | 平均训练准确率: 67.37
2025-11-21 21:39:59 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 13/30] 训练耗时: 29.58s | 平均训练准确率: 67.19
2025-11-21 21:40:29 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 14/30] 训练耗时: 29.71s | 平均训练准确率: 66.12
2025-11-21 21:40:58 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 15/30] 训练耗时: 28.85s | 平均训练准确率: 66.38
2025-11-21 21:41:26 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 16/30] 训练耗时: 27.82s | 平均训练准确率: 65.22
2025-11-21 21:41:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 17/30] 训练耗时: 24.91s | 平均训练准确率: 67.37
2025-11-21 21:42:20 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 18/30] 训练耗时: 29.63s | 平均训练准确率: 67.01
2025-11-21 21:42:49 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 19/30] 训练耗时: 28.94s | 平均训练准确率: 66.88
2025-11-21 21:43:18 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 20/30] 训练耗时: 28.37s | 平均训练准确率: 66.70
2025-11-21 21:43:47 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 21/30] 训练耗时: 29.11s | 平均训练准确率: 67.05
2025-11-21 21:44:15 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 22/30] 训练耗时: 27.93s | 平均训练准确率: 66.88
2025-11-21 21:44:42 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 23/30] 训练耗时: 27.76s | 平均训练准确率: 66.83
2025-11-21 21:45:07 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 24/30] 训练耗时: 24.85s | 平均训练准确率: 67.10
2025-11-21 21:45:36 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 25/30] 训练耗时: 29.05s | 平均训练准确率: 66.83
2025-11-21 21:46:05 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 26/30] 训练耗时: 28.73s | 平均训练准确率: 65.89
2025-11-21 21:46:34 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 27/30] 训练耗时: 28.55s | 平均训练准确率: 66.83
2025-11-21 21:47:03 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 28/30] 训练耗时: 29.81s | 平均训练准确率: 66.61
2025-11-21 21:47:03 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:47:03 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:47:03 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     TEST START - Epoch 28/30
2025-11-21 21:47:03 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:47:03 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    49.62 |      50.38 |    70.42 |
| Client 1 |    91.48 |       8.52 |    91.53 |
| Client 2 |    64.29 |      35.71 |    65.36 |
| Client 3 |    73.46 |      26.54 |    75.25 |
| Client 4 |    79.19 |      20.81 |    75.58 |
| Client 5 |    87.90 |      12.10 |    87.02 |
| Client 6 |    68.42 |      31.58 |    76.12 |
| Client 7 |    91.58 |       8.42 |    82.14 |
| Client 8 |    91.08 |       8.92 |    86.46 |
| Client 9 |    83.98 |      16.02 |    83.75 |
| Average  |    78.10 |      21.90 |    79.36 |
+----------+----------+------------+----------+

2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    82.58 |      17.42 |    72.31 |
| Client 1 |    77.94 |      22.06 |    70.16 |
| Client 2 |    80.31 |      19.69 |    73.31 |
| Client 3 |    80.37 |      19.63 |    72.61 |
| Client 4 |    79.19 |      20.81 |    71.60 |
| Client 5 |    78.90 |      21.10 |    71.09 |
| Client 6 |    80.21 |      19.79 |    72.23 |
| Client 7 |    76.42 |      23.58 |    70.86 |
| Client 8 |    76.83 |      23.17 |    70.72 |
| Client 9 |    78.49 |      21.51 |    72.26 |
| Average  |    79.12 |      20.88 |    71.72 |
+----------+----------+------------+----------+

2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     测试耗时: 193.94s
2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:50:17 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:50:40 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 29/30] 训练耗时: 22.70s | 平均训练准确率: 66.79
2025-11-21 21:50:40 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:50:40 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:50:40 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     TEST START - Epoch 29/30
2025-11-21 21:50:40 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:50:40 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    65.91 |      34.09 |    76.53 |
| Client 1 |    89.20 |      10.80 |    90.53 |
| Client 2 |    67.53 |      32.47 |    71.57 |
| Client 3 |    87.65 |      12.35 |    87.60 |
| Client 4 |    89.59 |      10.41 |    89.68 |
| Client 5 |    94.27 |       5.73 |    96.08 |
| Client 6 |    67.84 |      32.16 |    72.67 |
| Client 7 |    92.82 |       7.18 |    83.27 |
| Client 8 |    92.53 |       7.47 |    85.86 |
| Client 9 |    81.55 |      18.45 |    79.26 |
| Average  |    82.89 |      17.11 |    83.31 |
+----------+----------+------------+----------+

2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    86.83 |      13.17 |    79.08 |
| Client 1 |    82.92 |      17.08 |    76.74 |
| Client 2 |    85.16 |      14.84 |    79.82 |
| Client 3 |    83.15 |      16.85 |    77.67 |
| Client 4 |    83.65 |      16.35 |    78.29 |
| Client 5 |    81.80 |      18.20 |    75.53 |
| Client 6 |    82.04 |      17.96 |    76.27 |
| Client 7 |    78.75 |      21.25 |    74.70 |
| Client 8 |    78.00 |      22.00 |    72.89 |
| Client 9 |    80.04 |      19.96 |    74.58 |
| Average  |    82.23 |      17.77 |    76.56 |
+----------+----------+------------+----------+

2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     测试耗时: 190.63s
2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:53:51 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:54:14 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | [Epoch 30/30] 训练耗时: 22.87s | 平均训练准确率: 72.77
2025-11-21 21:54:14 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:54:14 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:54:14 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     TEST START - Epoch 30/30
2025-11-21 21:54:14 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:54:14 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    59.90 |      40.10 |    72.31 |
| Client 1 |    88.07 |      11.93 |    87.57 |
| Client 2 |    64.94 |      35.06 |    67.23 |
| Client 3 |    82.10 |      17.90 |    81.29 |
| Client 4 |    78.73 |      21.27 |    80.40 |
| Client 5 |    92.36 |       7.64 |    94.17 |
| Client 6 |    68.42 |      31.58 |    76.73 |
| Client 7 |    90.84 |       9.16 |    82.33 |
| Client 8 |    90.60 |       9.40 |    83.92 |
| Client 9 |    90.78 |       9.22 |    87.51 |
| Average  |    80.67 |      19.33 |    81.35 |
+----------+----------+------------+----------+

2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    82.87 |      17.13 |    73.66 |
| Client 1 |    82.13 |      17.87 |    76.40 |
| Client 2 |    83.47 |      16.53 |    78.63 |
| Client 3 |    79.42 |      20.58 |    72.66 |
| Client 4 |    78.61 |      21.39 |    70.43 |
| Client 5 |    80.89 |      19.11 |    74.22 |
| Client 6 |    81.39 |      18.61 |    73.73 |
| Client 7 |    76.81 |      23.19 |    70.98 |
| Client 8 |    76.15 |      23.85 |    66.59 |
| Client 9 |    79.15 |      20.85 |    70.89 |
| Average  |    80.09 |      19.91 |    72.82 |
+----------+----------+------------+----------+

2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] |                     测试耗时: 189.31s
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | ================================================================================
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | 
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | maximum test local acc: 82.891
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | mean of local acc: 80.555
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | maximum test neighbor acc: 82.233
2025-11-21 21:57:23 | INFO | caltech-101_sepfpl_hcse_1_0.01_10_[21/60] | mean of neighbor acc: 80.481
