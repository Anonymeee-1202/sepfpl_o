2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Loading trainer: DP_FPL
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Loading dataset: Caltech101
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Reading split from %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Creating a baseline federated dataset
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | class_num %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Creating a baseline federated dataset
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | class_num %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | user class dict total %s
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | idx: %s, output_dict_len: %d
2025-11-21 22:20:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 22:20:48 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Building custom CLIP
2025-11-21 22:20:48 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | Turning off gradients in both the image and the text encoder
2025-11-21 22:20:49 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank4-noise0.01-seed1-users10-25/60, mode=offline
2025-11-21 22:21:23 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 1/30] 训练耗时: 31.42s | 平均训练准确率: 66.16
2025-11-21 22:21:52 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 2/30] 训练耗时: 29.27s | 平均训练准确率: 65.98
2025-11-21 22:22:19 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 3/30] 训练耗时: 26.52s | 平均训练准确率: 65.94
2025-11-21 22:22:47 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 4/30] 训练耗时: 28.26s | 平均训练准确率: 66.21
2025-11-21 22:23:17 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 5/30] 训练耗时: 29.40s | 平均训练准确率: 66.83
2025-11-21 22:23:45 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 6/30] 训练耗时: 28.13s | 平均训练准确率: 67.32
2025-11-21 22:24:15 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 7/30] 训练耗时: 30.32s | 平均训练准确率: 66.88
2025-11-21 22:24:44 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 8/30] 训练耗时: 29.12s | 平均训练准确率: 67.99
2025-11-21 22:25:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 9/30] 训练耗时: 27.01s | 平均训练准确率: 65.31
2025-11-21 22:25:36 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 10/30] 训练耗时: 24.77s | 平均训练准确率: 66.29
2025-11-21 22:26:05 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 11/30] 训练耗时: 28.76s | 平均训练准确率: 66.12
2025-11-21 22:26:35 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 12/30] 训练耗时: 30.13s | 平均训练准确率: 67.46
2025-11-21 22:27:05 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 13/30] 训练耗时: 30.64s | 平均训练准确率: 67.19
2025-11-21 22:27:34 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 14/30] 训练耗时: 28.28s | 平均训练准确率: 65.89
2025-11-21 22:28:02 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 15/30] 训练耗时: 28.39s | 平均训练准确率: 67.01
2025-11-21 22:28:31 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 16/30] 训练耗时: 29.10s | 平均训练准确率: 66.29
2025-11-21 22:28:53 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 17/30] 训练耗时: 21.61s | 平均训练准确率: 67.90
2025-11-21 22:29:15 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 18/30] 训练耗时: 22.62s | 平均训练准确率: 65.98
2025-11-21 22:29:38 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 19/30] 训练耗时: 22.68s | 平均训练准确率: 66.52
2025-11-21 22:30:01 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 20/30] 训练耗时: 22.57s | 平均训练准确率: 65.94
2025-11-21 22:30:24 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 21/30] 训练耗时: 23.26s | 平均训练准确率: 67.46
2025-11-21 22:30:47 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 22/30] 训练耗时: 22.84s | 平均训练准确率: 66.29
2025-11-21 22:31:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 23/30] 训练耗时: 23.93s | 平均训练准确率: 66.74
2025-11-21 22:31:35 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 24/30] 训练耗时: 24.27s | 平均训练准确率: 66.29
2025-11-21 22:32:00 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 25/30] 训练耗时: 25.26s | 平均训练准确率: 65.94
2025-11-21 22:32:24 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 26/30] 训练耗时: 24.03s | 平均训练准确率: 67.05
2025-11-21 22:32:48 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 27/30] 训练耗时: 23.40s | 平均训练准确率: 65.94
2025-11-21 22:33:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 28/30] 训练耗时: 23.35s | 平均训练准确率: 65.71
2025-11-21 22:33:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:33:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:33:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     TEST START - Epoch 28/30
2025-11-21 22:33:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:33:11 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    48.62 |      51.38 |    70.04 |
| Client 1 |    90.91 |       9.09 |    90.29 |
| Client 2 |    66.23 |      33.77 |    66.90 |
| Client 3 |    69.14 |      30.86 |    74.98 |
| Client 4 |    81.45 |      18.55 |    78.34 |
| Client 5 |    87.26 |      12.74 |    86.72 |
| Client 6 |    66.08 |      33.92 |    73.14 |
| Client 7 |    90.35 |       9.65 |    79.60 |
| Client 8 |    90.60 |       9.40 |    86.28 |
| Client 9 |    78.16 |      21.84 |    76.92 |
| Average  |    76.88 |      23.12 |    78.32 |
+----------+----------+------------+----------+

2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    82.82 |      17.18 |    72.58 |
| Client 1 |    77.85 |      22.15 |    70.25 |
| Client 2 |    79.97 |      20.03 |    72.87 |
| Client 3 |    80.03 |      19.97 |    72.14 |
| Client 4 |    78.52 |      21.48 |    71.54 |
| Client 5 |    78.64 |      21.36 |    71.21 |
| Client 6 |    80.12 |      19.88 |    72.53 |
| Client 7 |    76.37 |      23.63 |    71.48 |
| Client 8 |    76.39 |      23.61 |    71.60 |
| Client 9 |    75.08 |      24.92 |    68.65 |
| Average  |    78.58 |      21.42 |    71.49 |
+----------+----------+------------+----------+

2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     测试耗时: 189.71s
2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:36:21 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:36:43 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 29/30] 训练耗时: 22.66s | 平均训练准确率: 64.69
2025-11-21 22:36:43 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:36:43 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:36:43 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     TEST START - Epoch 29/30
2025-11-21 22:36:43 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:36:43 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    65.66 |      34.34 |    75.49 |
| Client 1 |    88.07 |      11.93 |    89.83 |
| Client 2 |    67.53 |      32.47 |    71.55 |
| Client 3 |    80.86 |      19.14 |    81.35 |
| Client 4 |    87.78 |      12.22 |    87.66 |
| Client 5 |    94.27 |       5.73 |    95.87 |
| Client 6 |    65.50 |      34.50 |    71.26 |
| Client 7 |    92.33 |       7.67 |    81.76 |
| Client 8 |    89.64 |      10.36 |    83.11 |
| Client 9 |    85.44 |      14.56 |    82.58 |
| Average  |    81.71 |      18.29 |    82.05 |
+----------+----------+------------+----------+

2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    85.09 |      14.91 |    76.47 |
| Client 1 |    81.17 |      18.83 |    73.90 |
| Client 2 |    83.86 |      16.14 |    78.32 |
| Client 3 |    81.02 |      18.98 |    74.22 |
| Client 4 |    81.95 |      18.05 |    75.77 |
| Client 5 |    81.63 |      18.37 |    75.55 |
| Client 6 |    81.39 |      18.61 |    75.18 |
| Client 7 |    77.83 |      22.17 |    74.19 |
| Client 8 |    78.05 |      21.95 |    72.33 |
| Client 9 |    78.49 |      21.51 |    71.77 |
| Average  |    81.05 |      18.95 |    74.77 |
+----------+----------+------------+----------+

2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     测试耗时: 193.38s
2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:39:57 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:40:26 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | [Epoch 30/30] 训练耗时: 29.45s | 平均训练准确率: 71.21
2025-11-21 22:40:26 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:40:26 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:40:26 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     TEST START - Epoch 30/30
2025-11-21 22:40:26 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:40:26 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    59.15 |      40.85 |    72.16 |
| Client 1 |    89.20 |      10.80 |    88.04 |
| Client 2 |    64.94 |      35.06 |    67.06 |
| Client 3 |    82.72 |      17.28 |    81.82 |
| Client 4 |    76.02 |      23.98 |    75.11 |
| Client 5 |    91.72 |       8.28 |    92.98 |
| Client 6 |    69.01 |      30.99 |    77.60 |
| Client 7 |    91.83 |       8.17 |    84.13 |
| Client 8 |    89.40 |      10.60 |    82.71 |
| Client 9 |    85.92 |      14.08 |    82.51 |
| Average  |    79.99 |      20.01 |    80.41 |
+----------+----------+------------+----------+

2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    82.58 |      17.42 |    73.54 |
| Client 1 |    81.96 |      18.04 |    76.29 |
| Client 2 |    82.91 |      17.09 |    77.72 |
| Client 3 |    78.90 |      21.10 |    71.90 |
| Client 4 |    80.08 |      19.92 |    72.61 |
| Client 5 |    81.37 |      18.63 |    74.78 |
| Client 6 |    81.52 |      18.48 |    73.77 |
| Client 7 |    76.86 |      23.14 |    71.31 |
| Client 8 |    76.39 |      23.61 |    68.15 |
| Client 9 |    79.28 |      20.72 |    71.43 |
| Average  |    80.18 |      19.82 |    73.15 |
+----------+----------+------------+----------+

2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] |                     测试耗时: 259.86s
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | ================================================================================
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | 
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | maximum test local acc: 81.708
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | mean of local acc: 79.526
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | maximum test neighbor acc: 81.048
2025-11-21 22:44:46 | INFO | caltech-101_sepfpl_hcse_4_0.01_10_[25/60] | mean of neighbor acc: 79.936
