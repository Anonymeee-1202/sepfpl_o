2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Loading trainer: DP_FPL
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Loading dataset: Caltech101
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Reading split from %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Creating a baseline federated dataset
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | class_num %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Creating a baseline federated dataset
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | class_num %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | user class dict total %s
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | idx: %s, output_dict_len: %d
2025-11-21 21:57:31 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 21:57:33 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Building custom CLIP
2025-11-21 21:57:33 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | Turning off gradients in both the image and the text encoder
2025-11-21 21:57:33 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank2-noise0.01-seed1-users10-23/60, mode=offline
2025-11-21 21:58:01 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 1/30] 训练耗时: 25.11s | 平均训练准确率: 66.34
2025-11-21 21:58:25 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 2/30] 训练耗时: 23.87s | 平均训练准确率: 66.96
2025-11-21 21:58:49 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 3/30] 训练耗时: 23.63s | 平均训练准确率: 67.05
2025-11-21 21:59:20 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 4/30] 训练耗时: 30.83s | 平均训练准确率: 67.37
2025-11-21 21:59:49 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 5/30] 训练耗时: 29.61s | 平均训练准确率: 67.23
2025-11-21 22:00:18 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 6/30] 训练耗时: 29.11s | 平均训练准确率: 67.19
2025-11-21 22:00:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 7/30] 训练耗时: 28.65s | 平均训练准确率: 65.40
2025-11-21 22:01:16 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 8/30] 训练耗时: 28.66s | 平均训练准确率: 67.68
2025-11-21 22:01:43 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 9/30] 训练耗时: 27.65s | 平均训练准确率: 65.27
2025-11-21 22:02:07 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 10/30] 训练耗时: 23.41s | 平均训练准确率: 65.98
2025-11-21 22:02:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 11/30] 训练耗时: 31.28s | 平均训练准确率: 67.01
2025-11-21 22:03:08 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 12/30] 训练耗时: 29.91s | 平均训练准确率: 65.94
2025-11-21 22:03:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 13/30] 训练耗时: 29.62s | 平均训练准确率: 66.34
2025-11-21 22:04:06 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 14/30] 训练耗时: 28.13s | 平均训练准确率: 67.99
2025-11-21 22:04:34 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 15/30] 训练耗时: 28.34s | 平均训练准确率: 66.43
2025-11-21 22:05:01 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 16/30] 训练耗时: 27.30s | 平均训练准确率: 66.74
2025-11-21 22:05:25 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 17/30] 训练耗时: 23.60s | 平均训练准确率: 66.56
2025-11-21 22:05:53 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 18/30] 训练耗时: 28.05s | 平均训练准确率: 66.21
2025-11-21 22:06:22 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 19/30] 训练耗时: 28.94s | 平均训练准确率: 66.88
2025-11-21 22:06:52 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 20/30] 训练耗时: 29.61s | 平均训练准确率: 66.38
2025-11-21 22:07:20 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 21/30] 训练耗时: 28.24s | 平均训练准确率: 68.44
2025-11-21 22:07:49 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 22/30] 训练耗时: 29.47s | 平均训练准确率: 67.05
2025-11-21 22:08:16 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 23/30] 训练耗时: 26.46s | 平均训练准确率: 66.74
2025-11-21 22:08:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 24/30] 训练耗时: 22.17s | 平均训练准确率: 66.52
2025-11-21 22:09:01 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 25/30] 训练耗时: 23.63s | 平均训练准确率: 66.88
2025-11-21 22:09:25 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 26/30] 训练耗时: 23.70s | 平均训练准确率: 66.70
2025-11-21 22:09:49 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 27/30] 训练耗时: 23.71s | 平均训练准确率: 68.21
2025-11-21 22:10:13 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 28/30] 训练耗时: 24.33s | 平均训练准确率: 66.74
2025-11-21 22:10:13 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:10:13 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:10:13 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     TEST START - Epoch 28/30
2025-11-21 22:10:13 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:10:13 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    50.88 |      49.12 |    70.99 |
| Client 1 |    90.91 |       9.09 |    91.16 |
| Client 2 |    61.69 |      38.31 |    62.52 |
| Client 3 |    73.46 |      26.54 |    74.79 |
| Client 4 |    78.28 |      21.72 |    73.99 |
| Client 5 |    87.90 |      12.10 |    87.02 |
| Client 6 |    67.84 |      32.16 |    75.57 |
| Client 7 |    92.33 |       7.67 |    83.18 |
| Client 8 |    89.64 |      10.36 |    84.01 |
| Client 9 |    85.44 |      14.56 |    84.49 |
| Average  |    77.83 |      22.17 |    78.77 |
+----------+----------+------------+----------+

2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    83.11 |      16.89 |    73.01 |
| Client 1 |    78.51 |      21.49 |    70.77 |
| Client 2 |    80.53 |      19.47 |    73.53 |
| Client 3 |    80.37 |      19.63 |    72.73 |
| Client 4 |    79.50 |      20.50 |    72.09 |
| Client 5 |    79.07 |      20.93 |    71.20 |
| Client 6 |    80.38 |      19.62 |    72.30 |
| Client 7 |    76.56 |      23.44 |    71.30 |
| Client 8 |    77.61 |      22.39 |    71.20 |
| Client 9 |    78.84 |      21.16 |    71.75 |
| Average  |    79.45 |      20.55 |    71.99 |
+----------+----------+------------+----------+

2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     测试耗时: 190.94s
2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:13:24 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:13:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 29/30] 训练耗时: 23.31s | 平均训练准确率: 66.92
2025-11-21 22:13:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:13:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:13:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     TEST START - Epoch 29/30
2025-11-21 22:13:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:13:47 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    65.91 |      34.09 |    77.30 |
| Client 1 |    88.64 |      11.36 |    90.31 |
| Client 2 |    66.23 |      33.77 |    70.08 |
| Client 3 |    87.04 |      12.96 |    87.02 |
| Client 4 |    89.14 |      10.86 |    88.65 |
| Client 5 |    92.99 |       7.01 |    95.01 |
| Client 6 |    66.67 |      33.33 |    72.36 |
| Client 7 |    92.57 |       7.43 |    82.23 |
| Client 8 |    90.12 |       9.88 |    84.27 |
| Client 9 |    87.38 |      12.62 |    84.58 |
| Average  |    82.67 |      17.33 |    83.18 |
+----------+----------+------------+----------+

2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    86.59 |      13.41 |    78.70 |
| Client 1 |    82.70 |      17.30 |    76.42 |
| Client 2 |    85.68 |      14.32 |    80.39 |
| Client 3 |    82.72 |      17.28 |    77.17 |
| Client 4 |    83.33 |      16.67 |    77.70 |
| Client 5 |    82.28 |      17.72 |    75.99 |
| Client 6 |    81.82 |      18.18 |    75.95 |
| Client 7 |    78.07 |      21.93 |    74.14 |
| Client 8 |    78.68 |      21.32 |    72.89 |
| Client 9 |    79.33 |      20.67 |    73.41 |
| Average  |    82.12 |      17.88 |    76.28 |
+----------+----------+------------+----------+

2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     测试耗时: 191.41s
2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:16:59 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:17:21 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | [Epoch 30/30] 训练耗时: 22.47s | 平均训练准确率: 72.81
2025-11-21 22:17:21 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:17:21 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:17:21 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     TEST START - Epoch 30/30
2025-11-21 22:17:21 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:17:21 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    59.90 |      40.10 |    72.51 |
| Client 1 |    90.34 |       9.66 |    88.92 |
| Client 2 |    64.29 |      35.71 |    66.54 |
| Client 3 |    82.72 |      17.28 |    81.82 |
| Client 4 |    77.38 |      22.62 |    77.93 |
| Client 5 |    91.72 |       8.28 |    94.14 |
| Client 6 |    69.59 |      30.41 |    78.55 |
| Client 7 |    92.33 |       7.67 |    84.93 |
| Client 8 |    90.60 |       9.40 |    84.40 |
| Client 9 |    84.47 |      15.53 |    80.16 |
| Average  |    80.33 |      19.67 |    80.99 |
+----------+----------+------------+----------+

2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    84.90 |      15.10 |    76.88 |
| Client 1 |    82.79 |      17.21 |    77.09 |
| Client 2 |    83.12 |      16.88 |    78.09 |
| Client 3 |    79.68 |      20.32 |    73.07 |
| Client 4 |    78.70 |      21.30 |    70.49 |
| Client 5 |    81.93 |      18.07 |    75.31 |
| Client 6 |    81.60 |      18.40 |    73.83 |
| Client 7 |    77.54 |      22.46 |    71.96 |
| Client 8 |    76.78 |      23.22 |    69.13 |
| Client 9 |    79.15 |      20.85 |    72.03 |
| Average  |    80.62 |      19.38 |    73.79 |
+----------+----------+------------+----------+

2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] |                     测试耗时: 196.92s
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | ================================================================================
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | 
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | maximum test local acc: 82.670
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | mean of local acc: 80.279
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | maximum test neighbor acc: 82.120
2025-11-21 22:20:38 | INFO | caltech-101_sepfpl_hcse_2_0.01_10_[23/60] | mean of neighbor acc: 80.729
