2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Loading trainer: DP_FPL
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Loading dataset: Caltech101
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Reading split from %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Creating a baseline federated dataset
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | class_num %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Creating a baseline federated dataset
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | class_num %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | user class dict total %s
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | idx: %s, output_dict_len: %d
2025-11-21 19:51:26 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 19:51:28 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Building custom CLIP
2025-11-21 19:51:28 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | Turning off gradients in both the image and the text encoder
2025-11-21 19:51:29 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank1-noise0.1-seed1-users10-11/60, mode=offline
2025-11-21 19:52:00 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 1/30] 训练耗时: 28.50s | 平均训练准确率: 67.59
2025-11-21 19:52:30 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 2/30] 训练耗时: 30.08s | 平均训练准确率: 67.46
2025-11-21 19:53:00 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 3/30] 训练耗时: 29.88s | 平均训练准确率: 65.76
2025-11-21 19:53:27 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 4/30] 训练耗时: 27.08s | 平均训练准确率: 66.52
2025-11-21 19:53:53 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 5/30] 训练耗时: 25.73s | 平均训练准确率: 68.04
2025-11-21 19:54:22 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 6/30] 训练耗时: 28.80s | 平均训练准确率: 67.14
2025-11-21 19:54:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 7/30] 训练耗时: 28.55s | 平均训练准确率: 65.71
2025-11-21 19:55:19 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 8/30] 训练耗时: 28.72s | 平均训练准确率: 66.79
2025-11-21 19:55:48 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 9/30] 训练耗时: 29.36s | 平均训练准确率: 66.16
2025-11-21 19:56:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 10/30] 训练耗时: 27.79s | 平均训练准确率: 66.03
2025-11-21 19:56:41 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 11/30] 训练耗时: 25.54s | 平均训练准确率: 65.85
2025-11-21 19:57:04 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 12/30] 训练耗时: 22.48s | 平均训练准确率: 67.37
2025-11-21 19:57:28 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 13/30] 训练耗时: 23.81s | 平均训练准确率: 67.19
2025-11-21 19:57:51 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 14/30] 训练耗时: 23.09s | 平均训练准确率: 66.12
2025-11-21 19:58:14 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 15/30] 训练耗时: 23.17s | 平均训练准确率: 66.38
2025-11-21 19:58:37 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 16/30] 训练耗时: 23.23s | 平均训练准确率: 65.22
2025-11-21 19:59:00 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 17/30] 训练耗时: 22.57s | 平均训练准确率: 67.37
2025-11-21 19:59:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 18/30] 训练耗时: 23.70s | 平均训练准确率: 67.01
2025-11-21 19:59:47 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 19/30] 训练耗时: 23.20s | 平均训练准确率: 66.88
2025-11-21 20:00:10 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 20/30] 训练耗时: 23.12s | 平均训练准确率: 66.70
2025-11-21 20:00:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 21/30] 训练耗时: 22.85s | 平均训练准确率: 67.05
2025-11-21 20:00:56 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 22/30] 训练耗时: 23.27s | 平均训练准确率: 66.88
2025-11-21 20:01:19 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 23/30] 训练耗时: 23.46s | 平均训练准确率: 66.83
2025-11-21 20:01:43 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 24/30] 训练耗时: 23.33s | 平均训练准确率: 67.10
2025-11-21 20:02:06 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 25/30] 训练耗时: 22.87s | 平均训练准确率: 66.83
2025-11-21 20:02:29 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 26/30] 训练耗时: 23.69s | 平均训练准确率: 65.89
2025-11-21 20:02:53 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 27/30] 训练耗时: 23.32s | 平均训练准确率: 66.83
2025-11-21 20:03:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 28/30] 训练耗时: 23.58s | 平均训练准确率: 66.61
2025-11-21 20:03:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:03:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:03:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     TEST START - Epoch 28/30
2025-11-21 20:03:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:03:16 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.40 |      41.60 |    76.70 |
| Client 1 |    92.61 |       7.39 |    92.20 |
| Client 2 |    66.88 |      33.12 |    70.82 |
| Client 3 |    80.86 |      19.14 |    81.68 |
| Client 4 |    90.50 |       9.50 |    91.17 |
| Client 5 |    85.35 |      14.65 |    86.43 |
| Client 6 |    73.68 |      26.32 |    79.17 |
| Client 7 |    90.10 |       9.90 |    77.97 |
| Client 8 |    88.67 |      11.33 |    80.79 |
| Client 9 |    84.47 |      15.53 |    82.19 |
| Average  |    81.15 |      18.85 |    81.91 |
+----------+----------+------------+----------+

2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    86.83 |      13.17 |    79.21 |
| Client 1 |    80.52 |      19.48 |    74.44 |
| Client 2 |    82.78 |      17.22 |    77.52 |
| Client 3 |    82.11 |      17.89 |    76.55 |
| Client 4 |    81.46 |      18.54 |    75.49 |
| Client 5 |    80.94 |      19.06 |    74.78 |
| Client 6 |    81.47 |      18.53 |    74.81 |
| Client 7 |    78.12 |      21.88 |    73.94 |
| Client 8 |    78.44 |      21.56 |    73.60 |
| Client 9 |    79.81 |      20.19 |    74.57 |
| Average  |    81.25 |      18.75 |    75.49 |
+----------+----------+------------+----------+

2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     测试耗时: 196.51s
2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:06:33 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:07:02 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 29/30] 训练耗时: 29.75s | 平均训练准确率: 70.36
2025-11-21 20:07:02 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:07:02 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:07:02 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     TEST START - Epoch 29/30
2025-11-21 20:07:02 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:07:02 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    69.67 |      30.33 |    82.51 |
| Client 1 |    93.18 |       6.82 |    93.65 |
| Client 2 |    66.88 |      33.12 |    69.37 |
| Client 3 |    82.72 |      17.28 |    83.77 |
| Client 4 |    91.40 |       8.60 |    90.88 |
| Client 5 |    94.27 |       5.73 |    96.22 |
| Client 6 |    84.21 |      15.79 |    87.32 |
| Client 7 |    96.04 |       3.96 |    92.75 |
| Client 8 |    97.35 |       2.65 |    96.31 |
| Client 9 |    95.15 |       4.85 |    95.50 |
| Average  |    87.09 |      12.91 |    88.83 |
+----------+----------+------------+----------+

2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.08 |       9.92 |    83.95 |
| Client 1 |    86.19 |      13.81 |    82.17 |
| Client 2 |    88.01 |      11.99 |    84.64 |
| Client 3 |    86.76 |      13.24 |    83.18 |
| Client 4 |    86.32 |      13.68 |    82.77 |
| Client 5 |    86.09 |      13.91 |    82.41 |
| Client 6 |    87.05 |      12.95 |    83.81 |
| Client 7 |    84.76 |      15.24 |    82.66 |
| Client 8 |    84.59 |      15.41 |    82.09 |
| Client 9 |    86.01 |      13.99 |    83.39 |
| Average  |    86.59 |      13.41 |    83.11 |
+----------+----------+------------+----------+

2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     测试耗时: 292.95s
2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:11:55 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:12:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | [Epoch 30/30] 训练耗时: 28.90s | 平均训练准确率: 75.85
2025-11-21 20:12:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:12:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:12:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     TEST START - Epoch 30/30
2025-11-21 20:12:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:12:24 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    56.14 |      43.86 |    74.00 |
| Client 1 |    93.18 |       6.82 |    92.15 |
| Client 2 |    64.94 |      35.06 |    68.03 |
| Client 3 |    75.31 |      24.69 |    78.92 |
| Client 4 |    91.40 |       8.60 |    92.58 |
| Client 5 |    95.54 |       4.46 |    97.02 |
| Client 6 |    75.44 |      24.56 |    82.53 |
| Client 7 |    93.56 |       6.44 |    89.56 |
| Client 8 |    92.05 |       7.95 |    87.47 |
| Client 9 |    94.17 |       5.83 |    94.45 |
| Average  |    83.17 |      16.83 |    85.67 |
+----------+----------+------------+----------+

2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    82.19 |      17.81 |    72.19 |
| Client 1 |    84.14 |      15.86 |    78.32 |
| Client 2 |    82.00 |      18.00 |    77.57 |
| Client 3 |    81.07 |      18.93 |    76.38 |
| Client 4 |    80.61 |      19.39 |    76.46 |
| Client 5 |    84.10 |      15.90 |    79.78 |
| Client 6 |    82.65 |      17.35 |    78.42 |
| Client 7 |    79.04 |      20.96 |    76.46 |
| Client 8 |    83.12 |      16.88 |    79.31 |
| Client 9 |    83.44 |      16.56 |    79.80 |
| Average  |    82.24 |      17.76 |    77.47 |
+----------+----------+------------+----------+

2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] |                     测试耗时: 205.20s
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | ================================================================================
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | 
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | maximum test local acc: 87.087
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | mean of local acc: 83.805
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | maximum test neighbor acc: 86.587
2025-11-21 20:15:50 | INFO | caltech-101_sepfpl_hcse_1_0.1_10_[11/60] | mean of neighbor acc: 83.357
