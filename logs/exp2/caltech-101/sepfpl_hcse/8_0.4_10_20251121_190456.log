2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Loading trainer: DP_FPL
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Loading dataset: Caltech101
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Reading split from %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Creating a baseline federated dataset
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | class_num %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Creating a baseline federated dataset
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | class_num %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | user class dict total %s
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | idx: %s, output_dict_len: %d
2025-11-21 19:04:56 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 19:04:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Building custom CLIP
2025-11-21 19:04:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | Turning off gradients in both the image and the text encoder
2025-11-21 19:04:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank8-noise0.4-seed1-users10-7/60, mode=offline
2025-11-21 19:05:26 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 1/30] 训练耗时: 24.42s | 平均训练准确率: 66.61
2025-11-21 19:05:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 2/30] 训练耗时: 23.25s | 平均训练准确率: 67.32
2025-11-21 19:06:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 3/30] 训练耗时: 23.89s | 平均训练准确率: 66.70
2025-11-21 19:06:37 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 4/30] 训练耗时: 23.64s | 平均训练准确率: 66.12
2025-11-21 19:07:05 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 5/30] 训练耗时: 28.32s | 平均训练准确率: 66.34
2025-11-21 19:07:34 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 6/30] 训练耗时: 28.59s | 平均训练准确率: 66.83
2025-11-21 19:08:04 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 7/30] 训练耗时: 30.30s | 平均训练准确率: 66.65
2025-11-21 19:08:33 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 8/30] 训练耗时: 28.53s | 平均训练准确率: 67.41
2025-11-21 19:09:02 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 9/30] 训练耗时: 28.92s | 平均训练准确率: 65.54
2025-11-21 19:09:30 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 10/30] 训练耗时: 28.35s | 平均训练准确率: 67.50
2025-11-21 19:09:53 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 11/30] 训练耗时: 22.93s | 平均训练准确率: 66.61
2025-11-21 19:10:22 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 12/30] 训练耗时: 28.56s | 平均训练准确率: 66.96
2025-11-21 19:10:51 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 13/30] 训练耗时: 29.27s | 平均训练准确率: 65.76
2025-11-21 19:11:20 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 14/30] 训练耗时: 29.24s | 平均训练准确率: 66.65
2025-11-21 19:11:48 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 15/30] 训练耗时: 28.25s | 平均训练准确率: 65.36
2025-11-21 19:12:18 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 16/30] 训练耗时: 29.90s | 平均训练准确率: 67.01
2025-11-21 19:12:48 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 17/30] 训练耗时: 29.52s | 平均训练准确率: 66.61
2025-11-21 19:13:12 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 18/30] 训练耗时: 23.91s | 平均训练准确率: 67.41
2025-11-21 19:13:42 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 19/30] 训练耗时: 29.99s | 平均训练准确率: 67.81
2025-11-21 19:14:12 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 20/30] 训练耗时: 30.02s | 平均训练准确率: 67.72
2025-11-21 19:14:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 21/30] 训练耗时: 27.37s | 平均训练准确率: 66.38
2025-11-21 19:15:10 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 22/30] 训练耗时: 30.61s | 平均训练准确率: 67.54
2025-11-21 19:15:38 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 23/30] 训练耗时: 28.13s | 平均训练准确率: 66.29
2025-11-21 19:16:05 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 24/30] 训练耗时: 27.11s | 平均训练准确率: 67.01
2025-11-21 19:16:27 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 25/30] 训练耗时: 21.71s | 平均训练准确率: 67.77
2025-11-21 19:16:51 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 26/30] 训练耗时: 24.44s | 平均训练准确率: 66.34
2025-11-21 19:17:15 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 27/30] 训练耗时: 24.15s | 平均训练准确率: 66.47
2025-11-21 19:17:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 28/30] 训练耗时: 23.50s | 平均训练准确率: 66.16
2025-11-21 19:17:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:17:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:17:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     TEST START - Epoch 28/30
2025-11-21 19:17:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:17:39 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.65 |      41.35 |    77.13 |
| Client 1 |    92.61 |       7.39 |    92.20 |
| Client 2 |    69.48 |      30.52 |    73.62 |
| Client 3 |    80.25 |      19.75 |    80.92 |
| Client 4 |    92.31 |       7.69 |    93.17 |
| Client 5 |    85.99 |      14.01 |    86.32 |
| Client 6 |    73.68 |      26.32 |    79.15 |
| Client 7 |    90.10 |       9.90 |    78.46 |
| Client 8 |    91.08 |       8.92 |    85.32 |
| Client 9 |    84.47 |      15.53 |    82.19 |
| Average  |    81.86 |      18.14 |    82.85 |
+----------+----------+------------+----------+

2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    87.46 |      12.54 |    80.27 |
| Client 1 |    81.35 |      18.65 |    75.81 |
| Client 2 |    83.12 |      16.88 |    77.99 |
| Client 3 |    82.46 |      17.54 |    77.40 |
| Client 4 |    81.60 |      18.40 |    76.09 |
| Client 5 |    81.63 |      18.37 |    76.01 |
| Client 6 |    82.56 |      17.44 |    76.54 |
| Client 7 |    79.48 |      20.52 |    75.20 |
| Client 8 |    79.17 |      20.83 |    74.30 |
| Client 9 |    81.10 |      18.90 |    76.35 |
| Average  |    81.99 |      18.01 |    76.60 |
+----------+----------+------------+----------+

2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     测试耗时: 191.43s
2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:20:50 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:21:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 29/30] 训练耗时: 23.37s | 平均训练准确率: 71.43
2025-11-21 19:21:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:21:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:21:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     TEST START - Epoch 29/30
2025-11-21 19:21:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:21:14 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    70.93 |      29.07 |    82.53 |
| Client 1 |    93.75 |       6.25 |    94.00 |
| Client 2 |    68.83 |      31.17 |    71.51 |
| Client 3 |    85.19 |      14.81 |    86.09 |
| Client 4 |    91.86 |       8.14 |    91.14 |
| Client 5 |    94.90 |       5.10 |    96.50 |
| Client 6 |    85.96 |      14.04 |    90.00 |
| Client 7 |    96.29 |       3.71 |    92.67 |
| Client 8 |    97.83 |       2.17 |    96.77 |
| Client 9 |    93.20 |       6.80 |    93.79 |
| Average  |    87.87 |      12.13 |    89.50 |
+----------+----------+------------+----------+

2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.80 |       9.20 |    85.44 |
| Client 1 |    86.89 |      13.11 |    83.18 |
| Client 2 |    88.49 |      11.51 |    85.33 |
| Client 3 |    87.36 |      12.64 |    84.23 |
| Client 4 |    86.54 |      13.46 |    83.70 |
| Client 5 |    86.74 |      13.26 |    83.47 |
| Client 6 |    87.31 |      12.69 |    84.04 |
| Client 7 |    85.59 |      14.41 |    83.66 |
| Client 8 |    85.02 |      14.98 |    82.60 |
| Client 9 |    86.59 |      13.41 |    84.13 |
| Average  |    87.14 |      12.86 |    83.98 |
+----------+----------+------------+----------+

2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     测试耗时: 189.81s
2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:24:23 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:24:46 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | [Epoch 30/30] 训练耗时: 22.98s | 平均训练准确率: 77.37
2025-11-21 19:24:46 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:24:46 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:24:46 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     TEST START - Epoch 30/30
2025-11-21 19:24:46 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:24:46 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    75.19 |      24.81 |    85.47 |
| Client 1 |    89.77 |      10.23 |    88.72 |
| Client 2 |    61.69 |      38.31 |    62.73 |
| Client 3 |    82.72 |      17.28 |    83.44 |
| Client 4 |    91.40 |       8.60 |    90.78 |
| Client 5 |    96.18 |       3.82 |    97.42 |
| Client 6 |    88.89 |      11.11 |    93.08 |
| Client 7 |    96.78 |       3.22 |    95.65 |
| Client 8 |    94.70 |       5.30 |    88.71 |
| Client 9 |    96.12 |       3.88 |    96.81 |
| Average  |    87.34 |      12.66 |    88.28 |
+----------+----------+------------+----------+

2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.76 |       9.24 |    84.60 |
| Client 1 |    87.72 |      12.28 |    83.14 |
| Client 2 |    90.09 |       9.91 |    86.62 |
| Client 3 |    88.93 |      11.07 |    84.71 |
| Client 4 |    88.64 |      11.36 |    84.64 |
| Client 5 |    88.04 |      11.96 |    83.82 |
| Client 6 |    88.75 |      11.25 |    83.95 |
| Client 7 |    87.43 |      12.57 |    83.99 |
| Client 8 |    87.90 |      12.10 |    84.41 |
| Client 9 |    88.27 |      11.73 |    85.07 |
| Average  |    88.65 |      11.35 |    84.49 |
+----------+----------+------------+----------+

2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] |                     测试耗时: 193.03s
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | ================================================================================
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | 
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | maximum test local acc: 87.874
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | mean of local acc: 85.693
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | maximum test neighbor acc: 88.653
2025-11-21 19:27:59 | INFO | caltech-101_sepfpl_hcse_8_0.4_10_[7/60] | mean of neighbor acc: 85.927
