2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Loading trainer: DP_FPL
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Loading dataset: Caltech101
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Reading split from %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Creating a baseline federated dataset
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | class_num %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Creating a baseline federated dataset
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | class_num %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | user class dict total %s
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | idx: %s, output_dict_len: %d
2025-11-21 20:15:57 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 20:16:00 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Building custom CLIP
2025-11-21 20:16:00 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | Turning off gradients in both the image and the text encoder
2025-11-21 20:16:00 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank2-noise0.1-seed1-users10-13/60, mode=offline
2025-11-21 20:16:33 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 1/30] 训练耗时: 30.28s | 平均训练准确率: 66.34
2025-11-21 20:17:01 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 2/30] 训练耗时: 27.48s | 平均训练准确率: 66.96
2025-11-21 20:17:24 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 3/30] 训练耗时: 22.65s | 平均训练准确率: 67.05
2025-11-21 20:17:50 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 4/30] 训练耗时: 26.41s | 平均训练准确率: 67.37
2025-11-21 20:18:15 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 5/30] 训练耗时: 24.72s | 平均训练准确率: 67.23
2025-11-21 20:18:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 6/30] 训练耗时: 23.35s | 平均训练准确率: 67.19
2025-11-21 20:19:01 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 7/30] 训练耗时: 23.14s | 平均训练准确率: 65.40
2025-11-21 20:19:24 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 8/30] 训练耗时: 23.00s | 平均训练准确率: 67.68
2025-11-21 20:19:47 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 9/30] 训练耗时: 23.29s | 平均训练准确率: 65.27
2025-11-21 20:20:10 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 10/30] 训练耗时: 22.59s | 平均训练准确率: 65.98
2025-11-21 20:20:33 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 11/30] 训练耗时: 23.40s | 平均训练准确率: 67.01
2025-11-21 20:20:56 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 12/30] 训练耗时: 22.71s | 平均训练准确率: 65.94
2025-11-21 20:21:19 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 13/30] 训练耗时: 22.69s | 平均训练准确率: 66.34
2025-11-21 20:21:42 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 14/30] 训练耗时: 23.21s | 平均训练准确率: 67.99
2025-11-21 20:22:05 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 15/30] 训练耗时: 22.73s | 平均训练准确率: 66.43
2025-11-21 20:22:28 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 16/30] 训练耗时: 22.98s | 平均训练准确率: 66.74
2025-11-21 20:22:51 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 17/30] 训练耗时: 23.32s | 平均训练准确率: 66.56
2025-11-21 20:23:14 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 18/30] 训练耗时: 23.24s | 平均训练准确率: 66.21
2025-11-21 20:23:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 19/30] 训练耗时: 24.12s | 平均训练准确率: 66.88
2025-11-21 20:24:02 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 20/30] 训练耗时: 23.35s | 平均训练准确率: 66.38
2025-11-21 20:24:25 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 21/30] 训练耗时: 23.32s | 平均训练准确率: 68.44
2025-11-21 20:24:49 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 22/30] 训练耗时: 23.56s | 平均训练准确率: 67.05
2025-11-21 20:25:12 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 23/30] 训练耗时: 23.53s | 平均训练准确率: 66.74
2025-11-21 20:25:37 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 24/30] 训练耗时: 24.44s | 平均训练准确率: 66.52
2025-11-21 20:26:03 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 25/30] 训练耗时: 26.26s | 平均训练准确率: 66.88
2025-11-21 20:26:27 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 26/30] 训练耗时: 24.20s | 平均训练准确率: 66.70
2025-11-21 20:26:53 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 27/30] 训练耗时: 25.69s | 平均训练准确率: 68.21
2025-11-21 20:27:21 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 28/30] 训练耗时: 28.08s | 平均训练准确率: 66.74
2025-11-21 20:27:21 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:27:21 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:27:21 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     TEST START - Epoch 28/30
2025-11-21 20:27:21 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:27:21 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.15 |      41.85 |    75.75 |
| Client 1 |    91.48 |       8.52 |    89.53 |
| Client 2 |    66.23 |      33.77 |    69.99 |
| Client 3 |    80.86 |      19.14 |    81.68 |
| Client 4 |    91.40 |       8.60 |    92.17 |
| Client 5 |    84.71 |      15.29 |    85.66 |
| Client 6 |    73.10 |      26.90 |    78.92 |
| Client 7 |    88.86 |      11.14 |    74.55 |
| Client 8 |    87.95 |      12.05 |    77.60 |
| Client 9 |    83.01 |      16.99 |    80.95 |
| Average  |    80.58 |      19.42 |    80.68 |
+----------+----------+------------+----------+

2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    86.74 |      13.26 |    78.95 |
| Client 1 |    80.38 |      19.62 |    74.20 |
| Client 2 |    82.56 |      17.44 |    77.10 |
| Client 3 |    81.59 |      18.41 |    75.70 |
| Client 4 |    80.84 |      19.16 |    74.59 |
| Client 5 |    80.50 |      19.50 |    74.05 |
| Client 6 |    80.86 |      19.14 |    73.73 |
| Client 7 |    77.20 |      22.80 |    72.63 |
| Client 8 |    77.27 |      22.73 |    72.01 |
| Client 9 |    78.66 |      21.34 |    72.64 |
| Average  |    80.66 |      19.34 |    74.56 |
+----------+----------+------------+----------+

2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     测试耗时: 196.82s
2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:30:38 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:31:18 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 29/30] 训练耗时: 40.58s | 平均训练准确率: 70.49
2025-11-21 20:31:18 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:31:18 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:31:18 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     TEST START - Epoch 29/30
2025-11-21 20:31:18 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:31:18 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    67.67 |      32.33 |    82.13 |
| Client 1 |    93.18 |       6.82 |    93.89 |
| Client 2 |    65.58 |      34.42 |    68.33 |
| Client 3 |    82.72 |      17.28 |    83.34 |
| Client 4 |    91.40 |       8.60 |    91.09 |
| Client 5 |    94.90 |       5.10 |    96.74 |
| Client 6 |    83.63 |      16.37 |    86.97 |
| Client 7 |    95.30 |       4.70 |    91.70 |
| Client 8 |    96.14 |       3.86 |    94.23 |
| Client 9 |    92.72 |       7.28 |    91.50 |
| Average  |    86.32 |      13.68 |    87.99 |
+----------+----------+------------+----------+

2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    89.79 |      10.21 |    83.89 |
| Client 1 |    85.54 |      14.46 |    81.22 |
| Client 2 |    87.54 |      12.46 |    83.82 |
| Client 3 |    86.54 |      13.46 |    82.78 |
| Client 4 |    85.61 |      14.39 |    81.55 |
| Client 5 |    85.57 |      14.43 |    81.67 |
| Client 6 |    86.40 |      13.60 |    82.79 |
| Client 7 |    84.13 |      15.87 |    81.40 |
| Client 8 |    83.61 |      16.39 |    80.67 |
| Client 9 |    85.48 |      14.52 |    82.68 |
| Average  |    86.02 |      13.98 |    82.25 |
+----------+----------+------------+----------+

2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     测试耗时: 256.13s
2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:35:34 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:36:11 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | [Epoch 30/30] 训练耗时: 36.59s | 平均训练准确率: 75.45
2025-11-21 20:36:11 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:36:11 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:36:11 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     TEST START - Epoch 30/30
2025-11-21 20:36:11 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:36:11 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.15 |      41.85 |    75.92 |
| Client 1 |    93.18 |       6.82 |    92.15 |
| Client 2 |    63.64 |      36.36 |    65.91 |
| Client 3 |    82.10 |      17.90 |    83.70 |
| Client 4 |    92.31 |       7.69 |    92.12 |
| Client 5 |    96.82 |       3.18 |    97.69 |
| Client 6 |    81.29 |      18.71 |    86.03 |
| Client 7 |    93.56 |       6.44 |    87.21 |
| Client 8 |    91.81 |       8.19 |    85.97 |
| Client 9 |    92.23 |       7.77 |    91.09 |
| Average  |    84.51 |      15.49 |    85.78 |
+----------+----------+------------+----------+

2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    84.95 |      15.05 |    76.16 |
| Client 1 |    84.93 |      15.07 |    79.35 |
| Client 2 |    86.80 |      13.20 |    82.20 |
| Client 3 |    86.15 |      13.85 |    81.10 |
| Client 4 |    85.29 |      14.71 |    80.96 |
| Client 5 |    84.58 |      15.42 |    80.42 |
| Client 6 |    85.57 |      14.43 |    81.11 |
| Client 7 |    82.78 |      17.22 |    80.21 |
| Client 8 |    83.07 |      16.93 |    80.48 |
| Client 9 |    83.84 |      16.16 |    80.85 |
| Average  |    84.80 |      15.20 |    80.28 |
+----------+----------+------------+----------+

2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] |                     测试耗时: 200.19s
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | ================================================================================
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | 
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | maximum test local acc: 86.324
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | mean of local acc: 83.803
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | maximum test neighbor acc: 86.020
2025-11-21 20:39:31 | INFO | caltech-101_sepfpl_hcse_2_0.1_10_[13/60] | mean of neighbor acc: 83.826
