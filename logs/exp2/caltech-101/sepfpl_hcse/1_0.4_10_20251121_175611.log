2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Loading trainer: DP_FPL
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Loading dataset: Caltech101
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Reading split from %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Creating a baseline federated dataset
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | class_num %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Creating a baseline federated dataset
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | class_num %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | user class dict total %s
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | idx: %s, output_dict_len: %d
2025-11-21 17:56:11 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Loading CLIP (backbone: ViT-B/16)
2025-11-21 17:56:14 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Building custom CLIP
2025-11-21 17:56:14 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | Turning off gradients in both the image and the text encoder
2025-11-21 17:56:14 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [wandb] 正在初始化实验：project=SepFPL, name=caltech-101-sepfpl_hcse-rank1-noise0.4-seed1-users10-1/60, mode=offline
2025-11-21 17:56:44 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 1/30] 训练耗时: 25.84s | 平均训练准确率: 67.59
2025-11-21 17:57:08 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 2/30] 训练耗时: 23.87s | 平均训练准确率: 67.46
2025-11-21 17:57:33 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 3/30] 训练耗时: 24.65s | 平均训练准确率: 65.76
2025-11-21 17:57:57 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 4/30] 训练耗时: 24.19s | 平均训练准确率: 66.52
2025-11-21 17:58:20 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 5/30] 训练耗时: 23.24s | 平均训练准确率: 68.04
2025-11-21 17:58:44 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 6/30] 训练耗时: 24.04s | 平均训练准确率: 67.14
2025-11-21 17:59:09 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 7/30] 训练耗时: 25.10s | 平均训练准确率: 65.71
2025-11-21 17:59:34 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 8/30] 训练耗时: 24.72s | 平均训练准确率: 66.79
2025-11-21 17:59:59 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 9/30] 训练耗时: 24.84s | 平均训练准确率: 66.16
2025-11-21 18:00:23 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 10/30] 训练耗时: 24.62s | 平均训练准确率: 66.03
2025-11-21 18:00:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 11/30] 训练耗时: 25.23s | 平均训练准确率: 65.85
2025-11-21 18:01:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 12/30] 训练耗时: 24.90s | 平均训练准确率: 67.37
2025-11-21 18:01:38 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 13/30] 训练耗时: 24.59s | 平均训练准确率: 67.19
2025-11-21 18:02:02 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 14/30] 训练耗时: 23.61s | 平均训练准确率: 66.12
2025-11-21 18:02:26 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 15/30] 训练耗时: 24.51s | 平均训练准确率: 66.38
2025-11-21 18:02:50 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 16/30] 训练耗时: 24.03s | 平均训练准确率: 65.22
2025-11-21 18:03:15 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 17/30] 训练耗时: 24.63s | 平均训练准确率: 67.37
2025-11-21 18:03:39 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 18/30] 训练耗时: 23.86s | 平均训练准确率: 67.01
2025-11-21 18:04:04 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 19/30] 训练耗时: 25.59s | 平均训练准确率: 66.88
2025-11-21 18:04:29 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 20/30] 训练耗时: 24.51s | 平均训练准确率: 66.70
2025-11-21 18:04:53 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 21/30] 训练耗时: 24.07s | 平均训练准确率: 67.05
2025-11-21 18:05:17 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 22/30] 训练耗时: 24.19s | 平均训练准确率: 66.88
2025-11-21 18:05:41 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 23/30] 训练耗时: 24.39s | 平均训练准确率: 66.83
2025-11-21 18:06:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 24/30] 训练耗时: 25.86s | 平均训练准确率: 67.10
2025-11-21 18:06:38 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 25/30] 训练耗时: 31.26s | 平均训练准确率: 66.83
2025-11-21 18:07:09 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 26/30] 训练耗时: 30.15s | 平均训练准确率: 65.89
2025-11-21 18:07:38 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 27/30] 训练耗时: 29.66s | 平均训练准确率: 66.83
2025-11-21 18:08:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 28/30] 训练耗时: 28.72s | 平均训练准确率: 66.61
2025-11-21 18:08:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:08:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:08:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     TEST START - Epoch 28/30
2025-11-21 18:08:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:08:07 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    58.65 |      41.35 |    76.87 |
| Client 1 |    92.05 |       7.95 |    90.96 |
| Client 2 |    67.53 |      32.47 |    71.89 |
| Client 3 |    80.86 |      19.14 |    81.68 |
| Client 4 |    92.31 |       7.69 |    93.16 |
| Client 5 |    85.99 |      14.01 |    86.32 |
| Client 6 |    74.85 |      25.15 |    79.80 |
| Client 7 |    90.59 |       9.41 |    79.72 |
| Client 8 |    91.33 |       8.67 |    85.83 |
| Client 9 |    84.47 |      15.53 |    82.19 |
| Average  |    81.86 |      18.14 |    82.84 |
+----------+----------+------------+----------+

2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    87.08 |      12.92 |    79.51 |
| Client 1 |    81.48 |      18.52 |    75.90 |
| Client 2 |    83.12 |      16.88 |    77.72 |
| Client 3 |    82.28 |      17.72 |    76.85 |
| Client 4 |    81.37 |      18.63 |    75.61 |
| Client 5 |    81.76 |      18.24 |    76.15 |
| Client 6 |    82.65 |      17.35 |    76.76 |
| Client 7 |    79.67 |      20.33 |    75.38 |
| Client 8 |    79.56 |      20.44 |    74.78 |
| Client 9 |    81.45 |      18.55 |    76.96 |
| Average  |    82.04 |      17.96 |    76.56 |
+----------+----------+------------+----------+

2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     TEST FINISH - Epoch 28/30
2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     测试耗时: 195.21s
2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:11:22 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:11:51 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 29/30] 训练耗时: 28.26s | 平均训练准确率: 71.61
2025-11-21 18:11:51 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:11:51 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:11:51 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     TEST START - Epoch 29/30
2025-11-21 18:11:51 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:11:51 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    71.68 |      28.32 |    83.57 |
| Client 1 |    93.18 |       6.82 |    93.65 |
| Client 2 |    68.18 |      31.82 |    71.15 |
| Client 3 |    85.19 |      14.81 |    86.48 |
| Client 4 |    92.31 |       7.69 |    92.05 |
| Client 5 |    96.18 |       3.82 |    97.42 |
| Client 6 |    85.96 |      14.04 |    90.00 |
| Client 7 |    96.29 |       3.71 |    93.10 |
| Client 8 |    98.07 |       1.93 |    97.01 |
| Client 9 |    95.15 |       4.85 |    95.93 |
| Average  |    88.22 |      11.78 |    90.04 |
+----------+----------+------------+----------+

2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    90.85 |       9.15 |    85.54 |
| Client 1 |    87.33 |      12.67 |    83.52 |
| Client 2 |    89.18 |      10.82 |    86.07 |
| Client 3 |    87.97 |      12.03 |    84.69 |
| Client 4 |    87.21 |      12.79 |    84.38 |
| Client 5 |    87.13 |      12.87 |    84.05 |
| Client 6 |    87.79 |      12.21 |    84.51 |
| Client 7 |    85.88 |      14.12 |    83.78 |
| Client 8 |    85.41 |      14.59 |    83.07 |
| Client 9 |    86.99 |      13.01 |    84.26 |
| Average  |    87.58 |      12.42 |    84.39 |
+----------+----------+------------+----------+

2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     TEST FINISH - Epoch 29/30
2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     测试耗时: 202.40s
2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:15:13 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:15:43 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | [Epoch 30/30] 训练耗时: 29.99s | 平均训练准确率: 77.19
2025-11-21 18:15:43 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:15:43 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:15:43 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     TEST START - Epoch 30/30
2025-11-21 18:15:43 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:15:43 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
================= Local Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    78.20 |      21.80 |    86.34 |
| Client 1 |    94.32 |       5.68 |    94.19 |
| Client 2 |    65.58 |      34.42 |    69.36 |
| Client 3 |    89.51 |      10.49 |    91.30 |
| Client 4 |    91.86 |       8.14 |    90.38 |
| Client 5 |    96.18 |       3.82 |    97.17 |
| Client 6 |    88.89 |      11.11 |    92.95 |
| Client 7 |    96.78 |       3.22 |    95.33 |
| Client 8 |    98.80 |       1.20 |    98.10 |
| Client 9 |    96.12 |       3.88 |    96.91 |
| Average  |    89.62 |      10.38 |    91.20 |
+----------+----------+------------+----------+

2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
================= Neighbor Test Results ==================
+----------+----------+------------+----------+
| Client   | Accuracy | Error Rate | Macro F1 |
+----------+----------+------------+----------+
| Client 0 |    92.59 |       7.41 |    88.58 |
| Client 1 |    89.52 |      10.48 |    86.43 |
| Client 2 |    92.08 |       7.92 |    89.69 |
| Client 3 |    90.62 |       9.38 |    87.16 |
| Client 4 |    90.24 |       9.76 |    87.18 |
| Client 5 |    89.86 |      10.14 |    86.72 |
| Client 6 |    90.32 |       9.68 |    86.85 |
| Client 7 |    88.69 |      11.31 |    86.24 |
| Client 8 |    88.00 |      12.00 |    85.22 |
| Client 9 |    88.84 |      11.16 |    86.45 |
| Average  |    90.08 |       9.92 |    87.05 |
+----------+----------+------------+----------+

2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     TEST FINISH - Epoch 30/30
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] |                     测试耗时: 185.43s
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | ================================================================================
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | 
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | maximum test local acc: 89.622
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | mean of local acc: 86.568
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | maximum test neighbor acc: 90.078
2025-11-21 18:18:48 | INFO | caltech-101_sepfpl_hcse_1_0.4_10_[1/60] | mean of neighbor acc: 86.565
